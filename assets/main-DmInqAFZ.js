import{L as s,C as l,T as B,c as ce,t as Q,a as h,b as ae,d as Z}from"./card_open-DIcfzGlm.js";const ue=[{name:"Hulk",numOfA:2,price:{yellow:0,blue:3,orange:5,red:3,purple:3},score:3,color:l.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Spider Man",numOfA:0,price:{yellow:7,blue:0,orange:0,red:3,purple:0},score:5,color:l.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Green Goblin",numOfA:0,price:{yellow:0,blue:7,orange:0,red:0,purple:3},score:5,color:l.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Doctor Octopus",numOfA:0,price:{yellow:0,blue:7,orange:0,red:0,purple:0},score:4,color:l.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Vision",numOfA:1,price:{yellow:3,blue:6,orange:0,red:3,purple:0},score:4,color:l.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Doctor Strange",numOfA:1,price:{yellow:0,blue:0,orange:0,red:0,purple:7},score:4,color:l.RED,levelColor:s.BLUE,isSelected:!1},{name:"Captain Marvel",numOfA:1,price:{yellow:0,blue:3,orange:6,red:0,purple:3},score:4,color:l.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Iron Fist",numOfA:0,price:{yellow:0,blue:0,orange:0,red:7,purple:0},score:4,color:l.RED,levelColor:s.BLUE,isSelected:!1},{name:"Thor",numOfA:2,price:{yellow:3,blue:3,orange:0,red:3,purple:5},score:3,color:l.RED,levelColor:s.BLUE,isSelected:!1},{name:"Loki",numOfA:0,price:{yellow:0,blue:3,orange:0,red:0,purple:7},score:5,color:l.RED,levelColor:s.BLUE,isSelected:!1},{name:"Gamora",numOfA:0,price:{yellow:0,blue:0,orange:3,red:7,purple:0},score:5,color:l.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Ant Man",numOfA:1,price:{yellow:3,blue:0,orange:3,red:6,purple:0},score:4,color:l.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Drax",numOfA:0,price:{yellow:0,blue:0,orange:7,red:0,purple:0},score:4,color:l.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Luke Cage",numOfA:0,price:{yellow:3,blue:0,orange:7,red:0,purple:0},score:5,color:l.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Captain America",numOfA:2,price:{yellow:5,blue:3,orange:3,red:0,purple:3},score:3,color:l.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Black Widow",numOfA:2,price:{yellow:3,blue:3,orange:0,red:5,purple:3},score:3,color:l.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Nova",numOfA:0,price:{yellow:0,blue:0,orange:3,red:3,purple:6},score:4,color:l.RED,levelColor:s.BLUE,isSelected:!1},{name:"Black Bolt",numOfA:0,price:{yellow:7,blue:0,orange:0,red:0,purple:0},score:4,color:l.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Iron Man",numOfA:2,price:{yellow:3,blue:5,orange:3,red:3,purple:0},score:3,color:l.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Black Panther",numOfA:1,price:{yellow:6,blue:0,orange:3,red:0,purple:3},score:4,color:l.ORANGE,levelColor:s.BLUE,isSelected:!1}];class J{card;color;cardLeft;x;y;width;height;constructor(e,o,r,i,n,c,a){this.card=e,this.color=o,this.cardLeft=r,this.x=i,this.y=n,this.width=c,this.height=a}draw(e){this.card!==null&&(e.fillStyle=this.color,e.fillRect(this.x,this.y,this.width,this.height),e.lineWidth=this.card.isSelected?5:1,e.strokeStyle=this.card.isSelected?"red":"black",e.strokeRect(this.x,this.y,this.width,this.height),e.fillStyle="white",e.font="20px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(`${this.cardLeft}`,this.x+this.width/2,this.y+this.height/2)),e.lineWidth=1}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}const de=[{name:"Prowler",numOfA:0,price:{yellow:0,blue:1,orange:1,red:2,purple:1},score:0,color:l.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Wong",numOfA:0,price:{yellow:1,blue:1,orange:2,red:1,purple:0},score:0,color:l.RED,levelColor:s.GREEN,isSelected:!1},{name:"Modok",numOfA:0,price:{yellow:0,blue:0,orange:2,red:2,purple:0},score:0,color:l.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Rocket",numOfA:0,price:{yellow:1,blue:0,orange:0,red:2,purple:0},score:0,color:l.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Abomination",numOfA:0,price:{yellow:0,blue:2,orange:1,red:1,purple:1},score:0,color:l.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Gorgon",numOfA:0,price:{yellow:2,blue:2,orange:0,red:0,purple:0},score:0,color:l.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Kraven",numOfA:0,price:{yellow:0,blue:3,orange:0,red:0,purple:0},score:0,color:l.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Spider Woman",numOfA:1,price:{yellow:1,blue:1,orange:0,red:3,purple:0},score:0,color:l.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Spider Man 2099",numOfA:0,price:{yellow:2,blue:0,orange:0,red:1,purple:0},score:0,color:l.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Sand Man",numOfA:0,price:{yellow:0,blue:0,orange:4,red:0,purple:0},score:1,color:l.RED,levelColor:s.GREEN,isSelected:!1},{name:"Crystal",numOfA:0,price:{yellow:0,blue:0,orange:2,red:0,purple:2},score:0,color:l.RED,levelColor:s.GREEN,isSelected:!1},{name:"Winter Soldier",numOfA:1,price:{yellow:0,blue:2,orange:1,red:2,purple:0},score:0,color:l.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Rhino",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:l.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Squirrel Girl",numOfA:1,price:{yellow:0,blue:0,orange:1,red:2,purple:2},score:0,color:l.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Task Master",numOfA:0,price:{yellow:4,blue:0,orange:0,red:0,purple:0},score:1,color:l.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Elektra",numOfA:0,price:{yellow:2,blue:0,orange:0,red:0,purple:2},score:0,color:l.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Vulture",numOfA:0,price:{yellow:0,blue:0,orange:0,red:4,purple:0},score:1,color:l.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Scarlet Spider",numOfA:0,price:{yellow:0,blue:1,orange:1,red:1,purple:2},score:0,color:l.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Spider Girl",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:l.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Lockjaw",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:l.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Lizard",numOfA:0,price:{yellow:0,blue:2,orange:0,red:0,purple:1},score:0,color:l.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Hawkeye",numOfA:1,price:{yellow:1,blue:2,orange:0,red:0,purple:2},score:0,color:l.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Mysterio",numOfA:0,price:{yellow:0,blue:0,orange:3,red:0,purple:0},score:0,color:l.RED,levelColor:s.GREEN,isSelected:!1},{name:"Valkyrie",numOfA:1,price:{yellow:3,blue:0,orange:1,red:0,purple:1},score:0,color:l.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Kingpin",numOfA:0,price:{yellow:1,blue:0,orange:0,red:0,purple:2},score:0,color:l.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Yondu",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:4},score:1,color:l.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Electro",numOfA:0,price:{yellow:0,blue:0,orange:2,red:1,purple:0},score:0,color:l.RED,levelColor:s.GREEN,isSelected:!1},{name:"Bullseye",numOfA:0,price:{yellow:0,blue:1,orange:1,red:2,purple:1},score:0,color:l.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Grand Master",numOfA:0,price:{yellow:1,blue:1,orange:0,red:1,purple:1},score:0,color:l.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Spider Ham",numOfA:0,price:{yellow:1,blue:0,orange:0,red:0,purple:2},score:0,color:l.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Silver Sable",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:3},score:0,color:l.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Wasp",numOfA:1,price:{yellow:2,blue:1,orange:2,red:0,purple:0},score:0,color:l.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Quake",numOfA:1,price:{yellow:0,blue:1,orange:3,red:0,purple:1},score:0,color:l.RED,levelColor:s.GREEN,isSelected:!1},{name:"Triton",numOfA:0,price:{yellow:1,blue:1,orange:1,red:1,purple:0},score:0,color:l.RED,levelColor:s.GREEN,isSelected:!1},{name:"America Chavez",numOfA:1,price:{yellow:1,blue:3,orange:0,red:1,purple:0},score:0,color:l.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Kate Bishop",numOfA:1,price:{yellow:0,blue:1,orange:0,red:1,purple:3},score:0,color:l.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Moon Knight",numOfA:0,price:{yellow:3,blue:0,orange:0,red:0,purple:0},score:0,color:l.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Scorpion",numOfA:0,price:{yellow:0,blue:4,orange:0,red:0,purple:0},score:1,color:l.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Ms. Marvel",numOfA:1,price:{yellow:2,blue:0,orange:2,red:1,purple:0},score:0,color:l.RED,levelColor:s.GREEN,isSelected:!1},{name:"Baron Zemo",numOfA:0,price:{yellow:0,blue:0,orange:0,red:3,purple:0},score:0,color:l.YELLOW,levelColor:s.GREEN,isSelected:!1}],he=[{name:"Hela",numOfA:0,price:{yellow:0,blue:6,orange:0,red:0,purple:0},score:3,color:l.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Cross Bones",numOfA:0,price:{yellow:4,blue:2,orange:1,red:0,purple:0},score:2,color:l.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Beta Ray Bill",numOfA:1,price:{yellow:0,blue:3,orange:2,red:3,purple:0},score:1,color:l.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Maximus",numOfA:0,price:{yellow:0,blue:2,orange:4,red:1,purple:0},score:2,color:l.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Quick Silver",numOfA:1,price:{yellow:2,blue:0,orange:0,red:3,purple:3},score:1,color:l.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Red Skull",numOfA:0,price:{yellow:0,blue:0,orange:6,red:0,purple:0},score:3,color:l.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Star Lord",numOfA:0,price:{yellow:0,blue:1,orange:2,red:4,purple:0},score:2,color:l.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"She Hulk",numOfA:1,price:{yellow:3,blue:0,orange:2,red:0,purple:2},score:1,color:l.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Okoye",numOfA:1,price:{yellow:3,blue:2,orange:0,red:0,purple:3},score:1,color:l.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Karnak",numOfA:0,price:{yellow:3,blue:0,orange:5,red:0,purple:0},score:2,color:l.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"The Collector",numOfA:0,price:{yellow:0,blue:0,orange:5,red:0,purple:0},score:2,color:l.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Medusa",numOfA:0,price:{yellow:0,blue:5,orange:3,red:0,purple:0},score:2,color:l.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Dare Devil",numOfA:0,price:{yellow:0,blue:0,orange:0,red:6,purple:0},score:3,color:l.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Miles Morales",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:5},score:2,color:l.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Black Cat",numOfA:0,price:{yellow:0,blue:0,orange:0,red:3,purple:5},score:2,color:l.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Scarlet Witch",numOfA:1,price:{yellow:2,blue:3,orange:0,red:2,purple:0},score:1,color:l.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Shuri",numOfA:1,price:{yellow:3,blue:2,orange:3,red:0,purple:0},score:1,color:l.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Nick Fury",numOfA:1,price:{yellow:0,blue:0,orange:3,red:3,purple:2},score:1,color:l.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Venom",numOfA:0,price:{yellow:0,blue:5,orange:0,red:0,purple:0},score:2,color:l.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Jessica Jones",numOfA:0,price:{yellow:6,blue:0,orange:0,red:0,purple:0},score:3,color:l.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Nebula",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:6},score:3,color:l.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Ghost Spider",numOfA:0,price:{yellow:0,blue:2,orange:1,red:0,purple:4},score:2,color:l.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Carnage",numOfA:0,price:{yellow:5,blue:0,orange:0,red:3,purple:0},score:2,color:l.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Ghost Rider",numOfA:0,price:{yellow:2,blue:4,orange:0,red:0,purple:1},score:2,color:l.RED,levelColor:s.ORANGE,isSelected:!1},{name:"War Machine",numOfA:1,price:{yellow:0,blue:2,orange:2,red:0,purple:3},score:1,color:l.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Ronan",numOfA:0,price:{yellow:5,blue:0,orange:0,red:0,purple:0},score:2,color:l.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Punisher",numOfA:0,price:{yellow:0,blue:0,orange:0,red:5,purple:0},score:2,color:l.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Falcon",numOfA:1,price:{yellow:3,blue:0,orange:0,red:3,purple:2},score:1,color:l.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Groot",numOfA:0,price:{yellow:0,blue:0,orange:0,red:5,purple:3},score:2,color:l.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Maria Hill",numOfA:1,price:{yellow:0,blue:2,orange:3,red:0,purple:2},score:1,color:l.YELLOW,levelColor:s.ORANGE,isSelected:!1}];function be(){return{yellow:4,blue:4,orange:0,red:0,purple:0}}function ve(){return{yellow:0,blue:0,orange:0,red:4,purple:4}}function Le(){return{yellow:4,blue:0,orange:4,red:0,purple:0}}function Ge(){return{yellow:0,blue:0,orange:4,red:0,purple:4}}function Ne(){return{yellow:0,blue:4,orange:0,red:4,purple:0}}function Pe(){return{yellow:3,blue:0,orange:3,red:0,purple:3}}function Be(){return{yellow:0,blue:3,orange:0,red:3,purple:3}}function xe(){return{yellow:3,blue:3,orange:0,red:3,purple:0}}const Ue=[be(),ve(),Le(),Ge(),Ne(),Pe(),Be(),xe()];class We{tokens;city;people;tmp;coveredCards;hasA;isWinner;constructor(){this.tokens=new B,this.city=[],this.people=[],this.tmp=new B,this.coveredCards=[],this.hasA=!1,this.isWinner=!1}addCard(e){this.people.push(e)}getCardsCount(e){return this.people.filter(o=>o.color===e).length}getYellowCardsCount(){return this.people.filter(e=>e.color===l.YELLOW).length}getBlueCardsCount(){return this.people.filter(e=>e.color===l.BLUE).length}getOrangeCardsCount(){return this.people.filter(e=>e.color===l.ORANGE).length}getRedCardsCount(){return this.people.filter(e=>e.color===l.RED).length}getPurpleCardsCount(){return this.people.filter(e=>e.color===l.PURPLE).length}showCity1(){return this.city.length>=1}showCity2(){return this.city.length>=2}showCity3(){return this.city.length>=3}showCity4(){return this.city.length>=4}showGreen(){return this.people.some(e=>e.levelColor===s.BLUE)}getScores(){const e=this.people.reduce((i,n)=>i+n.score,0),o=this.city.length*3,r=this.hasA?3:0;return e+o+r}getNumOfA(){return this.people.reduce((e,o)=>e+o.numOfA,0)}canWin(){return this.people.some(e=>e.color===l.YELLOW)&&this.getScores()>=1}isClean(){return this.tokens.equals(new B)&&this.city.length===0&&this.people.length===0&&this.coveredCards.length===0}}class Te{x;y;size;angle=0;targetAngle=0;cornerIndex=0;bounce=0;constructor(e,o,r=48){this.x=e,this.y=o,this.size=r}resetCornerIndex(){this.cornerIndex=0}pointTo(e,o){const r=e.length;o&&(this.cornerIndex=(this.cornerIndex+1)%r);const i=e[this.cornerIndex].x,n=e[this.cornerIndex].y;this.targetAngle=Math.atan2(n-this.y,i-this.x),this.bounce=1}draw(e){const o=this.x,r=this.y;this.angle=this.targetAngle,e.save(),e.translate(o,r),e.rotate(this.angle),e.font=`${this.size}px serif`,e.textAlign="center",e.textBaseline="middle",e.fillText("âžœ",0,0),e.restore()}contains(e,o){const r=e-this.x,i=o-this.y,n=Math.cos(-this.angle),c=Math.sin(-this.angle),a=r*n-i*c,u=r*c+i*n,d=this.size*.5;return a>=-d&&a<=d&&u>=-d&&u<=d}}let oe=0;function Ye(t){oe=t}let k=2;function Ie(t){k=t}let y=[];function Me(t){y=t}let P=new B;function De(t){P=t}let b=null;function H(t){b=t}let fe=[];function _e(t){fe=t}let pe=[];function je(t){pe=t}let Ee=[];function ze(t){Ee=t}let D=[];function He(t){D=t}class ge{city;width;height;x;y;constructor(e,o,r,i,n){this.city=e,this.x=o,this.y=r,this.width=i,this.height=n}draw(e){if(this.city===null)return;e.fillStyle="#fff",e.fillRect(this.x,this.y,this.width,this.height),e.strokeStyle="black",e.strokeRect(this.x,this.y,this.width,this.height);const o=this.width*4/9,r=this.height*4/9,i=r/9,n=Object.entries(this.city).filter(([u,d])=>d>0).slice(0,3),c=this.y+i,a=c+r+i;n.forEach(([u,d],p)=>{let E=0,w=0;if(p===0)E=this.x+this.width/2-o/2,w=c;else if(p===1&&n.length===2)E=this.x+this.width/2-o/2,w=a;else{const S=p===1?i:i*2+o;E=this.x+S,w=a}e.fillStyle=ce[u],e.fillRect(E,w,o,r),e.strokeStyle="black",e.strokeRect(E,w,o,r),e.fillStyle="black",e.font=`${r-4}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(String(d),E+o/2,w+r/2+r*.05)})}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}class T{img;path;width;height;x;y;constructor(e,o,r,i,n,c){this.path=e,this.x=o,this.y=r,this.width=i,this.height=n,e&&(this.img=new Image,this.img.onload=c,this.img.src=e)}draw(e){if(!this.img||!this.img.complete)return;const o=Math.min(this.width/this.img.width,this.height/this.img.height),r=this.img.width*o,i=this.img.height*o,n=this.x+(this.width-r)/2,c=this.y+(this.height-i)/2;e.drawImage(this.img,n,c,r,i)}}class L{text;color;x;y;r;width;height;isRect;show;constructor(e,o,r,i,n,c,a,u,d=!0){this.text=e,this.color=o,this.x=r,this.y=i,this.r=n,this.width=c,this.height=a,this.isRect=u,this.show=d}draw(e){let o=0,r=0,i=0;e.fillStyle=this.show?this.color:Q,e.strokeStyle=this.show?"black":Q,this.isRect?(e.fillRect(this.x,this.y,this.width,this.height),e.strokeRect(this.x,this.y,this.width,this.height),o=this.height,r=this.width/2,i=this.height/2):(e.beginPath(),e.arc(this.x+this.r,this.y+this.r,this.r,0,Math.PI*2),e.fill(),e.stroke(),o=this.r*2,r=this.r,i=this.r),this.show&&(e.fillStyle="black",e.font=`${o-4}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(this.text,this.x+r,this.y+i+i*2*.05))}contains(e,o){const r=this.isRect?this.width:this.r*2,i=this.isRect?this.height:this.r*2;return e>=this.x&&e<=this.x+r&&o>=this.y&&o<=this.y+i}}class me{text;width;height;x;y;constructor(e,o,r,i,n){this.text=e,this.x=o,this.y=r,this.width=i,this.height=n}draw(e){let o=this.height/2;e.fillStyle="black",e.font=`${o}px Arial`,e.textAlign="start",e.textBaseline="middle",e.fillText(this.text,this.x,this.y+o+o*2*.05)}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}const Fe="modulepreload",Xe=function(t){return"/WebMarvel/"+t},ie={},$e=function(e,o,r){let i=Promise.resolve();if(o&&o.length>0){let u=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),a=c?.nonce||c?.getAttribute("nonce");i=u(o.map(d=>{if(d=Xe(d),d in ie)return;ie[d]=!0;const p=d.endsWith(".css"),E=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${E}`))return;const w=document.createElement("link");if(w.rel=p?"stylesheet":Fe,p||(w.as="script"),w.crossOrigin="",w.href=d,a&&w.setAttribute("nonce",a),document.head.appendChild(w),p)return new Promise((S,R)=>{w.addEventListener("load",S),w.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${d}`)))})}))}function n(c){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=c,window.dispatchEvent(a),!a.defaultPrevented)throw c}return i.then(c=>{for(const a of c||[])a.status==="rejected"&&n(a.reason);return e().catch(n)})};function Ke(t={}){const{immediate:e=!1,onNeedRefresh:o,onOfflineReady:r,onRegistered:i,onRegisteredSW:n,onRegisterError:c}=t;let a,u;const d=async(E=!0)=>{await u};async function p(){if("serviceWorker"in navigator){if(a=await $e(async()=>{const{Workbox:E}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:E}},[]).then(({Workbox:E})=>new E("/WebMarvel/sw.js",{scope:"/WebMarvel/",type:"classic"})).catch(E=>{c?.(E)}),!a)return;a.addEventListener("activated",E=>{(E.isUpdate||E.isExternal)&&window.location.reload()}),a.addEventListener("installed",E=>{E.isUpdate||r?.()}),a.register({immediate:e}).then(E=>{n?n("/WebMarvel/sw.js",E):i?.(E)}).catch(E=>{c?.(E)})}}return u=p(),d}Ke({immediate:!0});const V=[{id:"action_reset",icon:"ðŸ”„",title:"Reset",action:()=>{te()}},{id:"action_add_player",icon:"ðŸ‘«",title:"Add Player",action:()=>{Ie(k===2?3:k===3?4:2),te()}},{id:"action_manual",icon:"ðŸ“–",title:"Manual",action:()=>{const t=["./assets/manual1.png","./assets/manual2.png","./assets/manual3.png","./assets/manual4.png"],e=window.open("","_blank");if(e){const o=e.document.head,r=e.document.createElement("title");r.textContent="Manual",o.appendChild(r);const i=e.document.createElement("link");i.rel="icon",i.href="./assets/favicon.png",i.type="image/png",o.appendChild(i);const n=e.document.createElement("style");n.textContent=`
                body {
                    margin: 0;
                    padding: 20px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    background: #f0f0f0;
                }
                img {
                    max-width: 80%;
                    margin-bottom: 20px;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                    border-radius: 8px;
                }
            `,o.appendChild(n);const c=e.document.body;t.forEach(a=>{const u=e.document.createElement("img");u.src=a,c.appendChild(u)})}}},{id:"action_show_people",icon:"âœ‹",title:"show people",action:()=>{tt()}}];function F(t){const e=[...t];for(let o=e.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[e[o],e[r]]=[e[r],e[o]]}return e}function qe(){return _e(F(ue)),je(F(he)),ze(F(de)),[{backStack:fe,closeCard:new J(null,s.BLUE,0,0,0,0,0),openCards:[],color:s.BLUE,y:0},{backStack:pe,closeCard:new J(null,s.ORANGE,0,0,0,0,0),openCards:[],color:s.ORANGE,y:0},{backStack:Ee,closeCard:new J(null,s.GREEN,0,0,0,0,0),openCards:[],color:s.GREEN,y:0}]}function Je(){He(F(Ue).slice(0,k))}function Qe(){const e=7-(k===2?3:k===3?2:0);De(new B({[h.YELLOW]:e,[h.BLUE]:e,[h.ORANGE]:e,[h.RED]:e,[h.PURPLE]:e,[h.GRAY]:5}))}function Ze(){return Me(Array.from({length:k},()=>new We)),Array.from({length:k},()=>({people:[],tokens:[],green:new L("G","#0f0",0,0,0,0,0,!1,!1),tmpTokens:[],scores:new me("",0,0,0,0),cities:[],a:new T("",0,0,0,0,null),btnIn:new L("IN","#0f0",0,0,0,0,0,!0,!1),btnOut:new L("OUT","#0ff",0,0,0,0,0,!0,!1),showFirst:new T("",0,0,0,0,null),showWinner:new T("",0,0,0,0,null),coveredCards:[]}))}function Ve(t,e){ot(t,e),lt(t,e),rt(t,e),nt(t,e),st(t,e),ct(t,e),at(t,e),ut(t,e),se()}function G(){H(null),ue.forEach(t=>t.isSelected=!1),he.forEach(t=>t.isSelected=!1),de.forEach(t=>t.isSelected=!1),y.forEach(t=>{t.coveredCards.forEach(e=>e.isSelected=!1)})}function et(t){const e=g.cornerIndex,o=y[e].tmp.tokens;if(o[h.GRAY]!==0)return!1;if(t===h.GRAY)return Object.entries(o).filter(([u])=>u!==t.toString()).reduce((u,[,d])=>u+d,0)==0&&y[e].coveredCards.length<3;const r=Object.entries(o).filter(([c])=>c!==t.toString()&&t!==h.GRAY.toString());if(r.some(([,c])=>c===2))return!1;const n=r.reduce((c,[,a])=>c+a,0);return o[t]===0?n<=2:o[t]===1?n===0&&P.tokens[t]>=3:!1}function tt(){const t=window.open("show_people.html","hand");setTimeout(()=>{t?.postMessage({type:"HAND_UPDATE",players:y},"*")},300)}function ot(t,e){V.forEach(o=>{o.x<=t&&t<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&o.action()})}function lt(t,e){Y.forEach(o=>{if(o.contains(t,e)){const r=o.color;P.tokens[r]>0&&(et(r)?(P.tokens[r]--,o.value=P.tokens[r],y[g.cornerIndex].tmp.tokens[r]++):(q(),G()))}})}function rt(t,e){I.forEach(o=>{const r=o.closeCard,i=r.contains(t,e);i&&r.card!==null&&(G(),r.card.isSelected=i,H(r.card)),o.openCards.forEach(n=>{n.contains(t,e)&&n.card!==null&&(G(),n.card.isSelected=!0,H(n.card))})}),M.forEach((o,r)=>{r===g.cornerIndex&&o.coveredCards.forEach(i=>{i.contains(t,e)&&i.card!==null&&(G(),i.card.isSelected=!0,H(i.card))})})}function _(){const t=Se();g.pointTo(t,!0)}function we(){let t=!0;y.forEach(e=>{e.isClean()||(t=!1)}),t&&Ye(g.cornerIndex)}function nt(t,e){M.forEach((o,r)=>{o.btnIn.contains(t,e)?Ae(r):o.btnOut.contains(t,e)&&Re(r)})}function st(t,e){K.forEach((o,r)=>{if(o.contains(t,e))for(let i=0;i<=k;i++)Oe(i,r,!0)})}function it(t){const e=y[g.cornerIndex];e.tokens.tokens[t]--,e.tmp.tokens[t]++}function ct(t,e){M.forEach(o=>{o.tokens.forEach(r=>{r.contains(t,e)&&it(r.color)})})}function at(t,e){g.contains(t,e)&&(_(),we())}function ut(t,e){let o=v;o.x<=t&&t<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&Ae(g.cornerIndex),o=U,o.x<=t&&t<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&Re(g.cornerIndex)}function le(){const t=y[g.cornerIndex],e=t.tmp.tokens,o=t.tokens.tokens;for(const r of Object.values(h))o[r]+=e[r];t.tmp=new B}function q(){const t=y[g.cornerIndex],e=t.tmp.tokens,o=P.tokens;for(const r of Object.values(h))o[r]+=e[r];t.tmp=new B}function dt(){confirm("é€€éŒ¯è«‹æŒ‰ã€Œç¢ºå®šã€æ”¶å›žï¼›ä¸èƒ½ç›´æŽ¥æ‹¿ï¼è«‹æŒ‰ã€Œå–æ¶ˆã€é‚„éŠ€è¡Œ")?le():(q(),G())}function ht(){confirm("ç¢ºå®šä¸æ‹¿ç°è‰²ï¼Ÿ")&&y[g.cornerIndex].coveredCards.length<3&&re()}function ft(){confirm("ä¸èƒ½è²·ï¼Œæ˜¯å¦æ”¶å…¥è“‹ç‰Œä¸­ï¼Ÿ")&&y[g.cornerIndex].coveredCards.length<3&&re()}function Ce(){I.forEach(t=>{let e=t.closeCard.card;e!==null&&e==b&&(e=t.backStack.shift()??null),t.openCards.forEach(o=>{if(o.card!==null&&o.card==b){const r=t.backStack.shift()??null;o.card=r}})})}function re(){const t=g.cornerIndex,e=y[t];b!==null&&e.coveredCards.push(b),le(),Ce(),G();const o=e.showGreen()?1:0;Object.entries(e.tokens.tokens).reduce((i,[,n])=>i+n,0)+o<=10&&($(t),_())}function pt(t,e,o,r,i){if(b===null)return;const n=t+e+o+r+i,c=b,a=y[g.cornerIndex],u=a.tokens.tokens,d=Math.max(c.price[l.YELLOW]-a.getYellowCardsCount(),0),p=Math.max(c.price[l.BLUE]-a.getBlueCardsCount(),0),E=Math.max(c.price[l.ORANGE]-a.getOrangeCardsCount(),0),w=Math.max(c.price[l.RED]-a.getRedCardsCount(),0),S=Math.max(c.price[l.PURPLE]-a.getPurpleCardsCount(),0);u[h.YELLOW]-=d,u[h.YELLOW]=Math.max(u[h.YELLOW],0),u[h.BLUE]-=p,u[h.BLUE]=Math.max(u[h.BLUE],0),u[h.ORANGE]-=E,u[h.ORANGE]=Math.max(u[h.ORANGE],0),u[h.RED]-=w,u[h.RED]=Math.max(u[h.RED],0),u[h.PURPLE]-=S,u[h.PURPLE]=Math.max(u[h.PURPLE],0),u[h.GRAY]-=n;const R=P.tokens;R[h.YELLOW]+=d-t,R[h.BLUE]+=p-e,R[h.ORANGE]+=E-o,R[h.RED]+=w-r,R[h.PURPLE]+=S-i,R[h.GRAY]+=n}function ye(){const t=y.find(r=>r.hasA),e=y.filter(r=>r.getNumOfA()>=3).sort((r,i)=>i.getNumOfA()-r.getNumOfA());if(e.length===0)return;const o=e[0];if(!t){o.hasA=!0;return}o.getNumOfA()>t.getNumOfA()&&(t.hasA=!1,o.hasA=!0)}function Et(){const t=g.cornerIndex,e=y[t],o=[];D.forEach((i,n)=>{i!==null&&i[l.YELLOW]<=e.getYellowCardsCount()&&i[l.BLUE]<=e.getBlueCardsCount()&&i[l.ORANGE]<=e.getOrangeCardsCount()&&i[l.RED]<=e.getRedCardsCount()&&i[l.PURPLE]<=e.getPurpleCardsCount()&&o.push(n)});const r=o.length;return r===0?(ye(),!0):r===1?(Oe(t,o[0]),!0):(alert("è«‹é¸ä¸€å¼µåŸŽå¸‚å¡"),!1)}function Oe(t,e,o=!1){if(g.cornerIndex!==t)return;const i=y[t];let n=D[e];n!==null&&n[l.YELLOW]<=i.getYellowCardsCount()&&n[l.BLUE]<=i.getBlueCardsCount()&&n[l.ORANGE]<=i.getOrangeCardsCount()&&n[l.RED]<=i.getRedCardsCount()&&n[l.PURPLE]<=i.getPurpleCardsCount()&&(i.city.push(n),D[e]=null),ye(),o&&($(t),_())}function Ae(t){if(g.cornerIndex!==t)return;const e=y[t],o=e.tokens.tokens,r=e.tmp.tokens;if(r[h.GRAY]!==0)if(b===null||e.coveredCards.some(c=>c.name===b?.name)){dt();return}else{re();return}const n=Object.entries(r).filter(([c])=>c!==h.GRAY.toString()).reduce((c,[,a])=>c+a,0);if(b==null)if(n>0){le();const c=e.showGreen()?1:0;Object.entries(o).reduce((u,[,d])=>u+d,0)+c<=10&&($(t),_())}else return;else if(n>0)q(),G();else{if(e.coveredCards.length<3&&I.some(O=>O.closeCard.card==b)){ht();return}const c=b,a=e.getYellowCardsCount()+o[h.YELLOW],u=e.getBlueCardsCount()+o[h.BLUE],d=e.getOrangeCardsCount()+o[h.ORANGE],p=e.getRedCardsCount()+o[h.RED],E=e.getPurpleCardsCount()+o[h.PURPLE],w=c.price[l.YELLOW]>a?c.price[l.YELLOW]-a:0,S=c.price[l.BLUE]>u?c.price[l.BLUE]-u:0,R=c.price[l.ORANGE]>d?c.price[l.ORANGE]-d:0,j=c.price[l.RED]>p?c.price[l.RED]-p:0,z=c.price[l.PURPLE]>E?c.price[l.PURPLE]-E:0,x=w+S+R+j+z;if(o[h.GRAY]>=x){if(pt(w,S,R,j,z),e.addCard(c),e.coveredCards.some(A=>A.name===c.name)){const A=e.coveredCards.findIndex(N=>N.name===c.name);A!==-1&&e.coveredCards.splice(A,1)}else Ce();Et()&&($(t),_())}else{ft();return}G()}}function Re(t){g.cornerIndex===t&&(q(),G())}function $(t){if(t!==(k-1+oe)%k)return;if(Array.from({length:k},(c,a)=>y[a].canWin())[t]){y[t].isWinner=!0;return}const o=y.filter(c=>c.canWin());if(o.length===0)return;const r=o.sort((c,a)=>a.getScores()-c.getScores()),i=r.filter(c=>c.getScores()===r[0].getScores());if(i.length===1){i[0].isWinner=!0;return}console.log("===Blaze=== 5");const n=i.find(c=>c.hasA);if(n)n.isWinner=!0;else{const c=i.sort((u,d)=>u.people.length-d.people.length);c.filter(u=>u.people.length===c[0].people.length).forEach(u=>u.isWinner=!0)}}let I=[],K=[],Y=[],M=[];const g=new Te(200,200,48),v=new L("IN","#0f0",0,0,0,400,200,!0,!0),U=new L("OUT","#0ff",0,0,0,400,200,!0,!0),C=document.getElementById("canvas"),m=C.getContext("2d"),f=10,gt=1/20,mt=1/30,wt=1/50,Ct=1/40,yt=1/40;let ee=0,ne=0,ke=0;function Ot(){const t=C.width*gt,e=t*2,o=t+f,r=C.width/2-t*1.5-f*1;ne=r+t*4+f*3;const i=(C.height-W)/2-e*1-f;ee=i,I.forEach((n,c)=>{if(n.y=i+c*(e+f),n.openCards.length===0)for(let u=0;u<4;u++){const d=n.backStack.shift()??null;n.openCards.push(new ae(d,n.color,r+u*o,n.y,t,e))}else n.openCards.forEach((u,d)=>{u.x=r+d*o,u.y=n.y,u.width=t,u.height=e});const a=n.backStack.length;n.closeCard.card=a>0?n.backStack[0]:null,n.closeCard.cardLeft=a,n.closeCard.x=r-o,n.closeCard.y=n.y,n.closeCard.width=t,n.closeCard.height=e})}function At(){const t=C.width*mt,e=t,o=t+f,r=ne+f;ke=ee+2*e+f,K=[],D.forEach((i,n)=>{const c=n%2,a=n<2?0:1;K.push(new ge(i,r+c*o,ee+a*(e+f),t,e))})}function Rt(){const t=C.width*Ct/2,e=t*2+f,o=ne+f,r=ke+f;Y=[],Object.values(h).forEach((i,n)=>{const c=n%2,a=Math.floor(n/2);Y.push(new Z(P.tokens[i],i,o+c*e,r+a*e,t))})}function kt(){const t=C.width*wt,e=t*6+f*4,o=.8,r=f+(t+f)*8+(t*o+f)*3,i=4;M.forEach((n,c)=>{const a=y[c],u=c<2?f:C.width-f-r;let d=u+t,p=c===0||c===3?C.height-f-t:W+f+e;const E=c===0||c===3?p-e*2:p+t;let w=a.isWinner?"./assets/thanos.webp":"";const S=Math.min(r,e);n.showWinner=new T(w,u,E,S,S,X),n.btnIn=new L("IN","#0f0",d,p,0,t*2,t,!0,!0),d+=t*2+f*2,n.btnOut=new L("OUT","#0ff",d,p,0,t*2,t,!0,!0),d+=t*2+f*2,w=oe===c?"./assets/first.png":"",n.showFirst=new T(w,d,p,t*2,t,X),p-=t+f,d=u,n.scores=new me(`åˆ†ï¼š${a.getScores()} Aï¼š${a.getNumOfA()}`,d,p,t*4,t),d+=n.scores.width+f,a.city.forEach((O,A)=>{const N=new ge(O,d+A*(t+f),p,t,t);n.cities.push(N)});const R=a.city.length;let j=Array.from({length:i-R},(O,A)=>new L("",Q,d+(R+A)*(t+f),p,0,t,t,!0,!1));n.cities.push(...j),d+=i*(t+f),w=a.hasA?"./assets/marvel_a.png":"",n.a=new T(w,d,p,t,t,X),p-=t+f,d=u,n.tokens=[],Object.values(h).forEach(O=>{n.tokens.push(new Z(a.tokens.tokens[O],O,d,p,t/2)),d+=t+f});const z=a.showGreen();n.green=new L("G","#0F0",d,p,t/2,0,0,!1,z),d+=(t+f)*2,n.tmpTokens=[],Object.values(h).forEach(O=>{const A=a.tmp.tokens[O],N=n.tmpTokens.length;A>0&&n.tmpTokens.push(new Z(A,O,d+N*(t*.8+f),p,t*o/2))}),d=u,p-=t+f,n.people=[],Object.values(l).forEach((O,A)=>{const N=a.getCardsCount(O);n.people.push(new L(String(N),ce[O],d+A*(t+f),p,0,t,t,!0,N>0))});const x=t*1.5;p-=x*2+f,n.coveredCards=[],a.coveredCards.forEach((O,A)=>{n.coveredCards.push(new ae(O,O.color,d+A*(x+f),p,x,x*2))})})}function St(){const t=Y[Y.length-1];g.size=C.width*yt,g.x=t.x,g.y=t.y+t.r*2+f+g.size}function bt(){v.x=g.x-g.size,v.y=g.y+g.size+f,v.width=g.size*2,v.height=g.size,U.x=v.x,U.y=v.y+v.height+f,U.width=v.width,U.height=v.height}const W=30;function vt(){const t=C.width/V.length;V.forEach((e,o)=>{const r=o*t,i=0;e.x=r,e.y=i,e.width=t,e.height=W,m.fillStyle="#fff",m.fillRect(r+2,i,t-4,W),m.font="20px Arial",m.textAlign="center",m.textBaseline="middle",m.fillStyle="#000",m.fillText(e.icon,r+t/2-30,W/2),m.font="16px Arial",m.fillText(e.title,r+t/2+30,W/2)})}function Lt(){I.forEach(t=>{t.closeCard.draw(m),t.openCards.forEach(e=>e.draw(m))})}function Gt(){K.forEach(t=>t.draw(m))}function Nt(){Y.forEach(t=>t.draw(m))}function X(){M.forEach(t=>{t.people.forEach(e=>e.draw(m)),t.tokens.forEach(e=>e.draw(m)),t.green.draw(m),t.tmpTokens.forEach(e=>e.draw(m)),t.scores.draw(m),t.cities.forEach(e=>e.draw(m)),t.a.draw(m),t.btnIn.draw(m),t.btnOut.draw(m),t.showFirst.draw(m),t.coveredCards.forEach(e=>e.draw(m)),t.showWinner.draw(m)})}function Se(){return[{x:0,y:C.height},{x:0,y:0},{x:C.width,y:0},{x:C.width,y:C.height}].slice(0,k)}function Pt(){const t=Se();g.pointTo(t,!1),g.draw(m)}function Bt(){v.draw(m),U.draw(m)}function se(){console.log("===Blaze=== in draw"),m.clearRect(0,0,C.width,C.height),vt(),Ot(),Lt(),At(),Gt(),Rt(),Nt(),kt(),X(),St(),Pt(),bt(),Bt()}function te(){C.width=window.innerWidth,C.height=window.innerHeight,I=qe(),Je(),Qe(),M=Ze(),g.resetCornerIndex(),we(),se()}function xt(){C.width=window.innerWidth,C.height=window.innerHeight,se()}C.addEventListener("click",t=>{const e=C.getBoundingClientRect(),o=t.clientX-e.left,r=t.clientY-e.top;Ve(o,r)});window.addEventListener("resize",xt);te();
