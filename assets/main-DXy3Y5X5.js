import{L as s,C as r,T as B,c as ie,t as Q,a as h,b as ce,d as Z}from"./card_open-DIcfzGlm.js";const ae=[{name:"Hulk",numOfA:2,price:{yellow:0,blue:3,orange:5,red:3,purple:3},score:3,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Spider Man",numOfA:0,price:{yellow:7,blue:0,orange:0,red:3,purple:0},score:5,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Green Goblin",numOfA:0,price:{yellow:0,blue:7,orange:0,red:0,purple:3},score:5,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Doctor Octopus",numOfA:0,price:{yellow:0,blue:7,orange:0,red:0,purple:0},score:4,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Vision",numOfA:1,price:{yellow:3,blue:6,orange:0,red:3,purple:0},score:4,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Doctor Strange",numOfA:1,price:{yellow:0,blue:0,orange:0,red:0,purple:7},score:4,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Captain Marvel",numOfA:1,price:{yellow:0,blue:3,orange:6,red:0,purple:3},score:4,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Iron Fist",numOfA:0,price:{yellow:0,blue:0,orange:0,red:7,purple:0},score:4,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Thor",numOfA:2,price:{yellow:3,blue:3,orange:0,red:3,purple:5},score:3,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Loki",numOfA:0,price:{yellow:0,blue:3,orange:0,red:0,purple:7},score:5,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Gamora",numOfA:0,price:{yellow:0,blue:0,orange:3,red:7,purple:0},score:5,color:r.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Ant Man",numOfA:1,price:{yellow:3,blue:0,orange:3,red:6,purple:0},score:4,color:r.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Drax",numOfA:0,price:{yellow:0,blue:0,orange:7,red:0,purple:0},score:4,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Luke Cage",numOfA:0,price:{yellow:3,blue:0,orange:7,red:0,purple:0},score:5,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Captain America",numOfA:2,price:{yellow:5,blue:3,orange:3,red:0,purple:3},score:3,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Black Widow",numOfA:2,price:{yellow:3,blue:3,orange:0,red:5,purple:3},score:3,color:r.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Nova",numOfA:0,price:{yellow:0,blue:0,orange:3,red:3,purple:6},score:4,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Black Bolt",numOfA:0,price:{yellow:7,blue:0,orange:0,red:0,purple:0},score:4,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Iron Man",numOfA:2,price:{yellow:3,blue:5,orange:3,red:3,purple:0},score:3,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Black Panther",numOfA:1,price:{yellow:6,blue:0,orange:3,red:0,purple:3},score:4,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1}];class J{card;color;cardLeft;x;y;width;height;constructor(e,o,t,i,n,c,u){this.card=e,this.color=o,this.cardLeft=t,this.x=i,this.y=n,this.width=c,this.height=u}draw(e){this.card!==null&&(e.fillStyle=this.color,e.fillRect(this.x,this.y,this.width,this.height),e.lineWidth=this.card.isSelected?5:1,e.strokeStyle=this.card.isSelected?"red":"black",e.strokeRect(this.x,this.y,this.width,this.height),e.fillStyle="white",e.font="20px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(`${this.cardLeft}`,this.x+this.width/2,this.y+this.height/2)),e.lineWidth=1}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}const ue=[{name:"Prowler",numOfA:0,price:{yellow:0,blue:1,orange:1,red:2,purple:1},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Wong",numOfA:0,price:{yellow:1,blue:1,orange:2,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Modok",numOfA:0,price:{yellow:0,blue:0,orange:2,red:2,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Rocket",numOfA:0,price:{yellow:1,blue:0,orange:0,red:2,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Abomination",numOfA:0,price:{yellow:0,blue:2,orange:1,red:1,purple:1},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Gorgon",numOfA:0,price:{yellow:2,blue:2,orange:0,red:0,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Kraven",numOfA:0,price:{yellow:0,blue:3,orange:0,red:0,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Spider Woman",numOfA:1,price:{yellow:1,blue:1,orange:0,red:3,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Spider Man 2099",numOfA:0,price:{yellow:2,blue:0,orange:0,red:1,purple:0},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Sand Man",numOfA:0,price:{yellow:0,blue:0,orange:4,red:0,purple:0},score:1,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Crystal",numOfA:0,price:{yellow:0,blue:0,orange:2,red:0,purple:2},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Winter Soldier",numOfA:1,price:{yellow:0,blue:2,orange:1,red:2,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Rhino",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Squirrel Girl",numOfA:1,price:{yellow:0,blue:0,orange:1,red:2,purple:2},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Task Master",numOfA:0,price:{yellow:4,blue:0,orange:0,red:0,purple:0},score:1,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Elektra",numOfA:0,price:{yellow:2,blue:0,orange:0,red:0,purple:2},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Vulture",numOfA:0,price:{yellow:0,blue:0,orange:0,red:4,purple:0},score:1,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Scarlet Spider",numOfA:0,price:{yellow:0,blue:1,orange:1,red:1,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Spider Girl",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Lockjaw",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Lizard",numOfA:0,price:{yellow:0,blue:2,orange:0,red:0,purple:1},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Hawkeye",numOfA:1,price:{yellow:1,blue:2,orange:0,red:0,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Mysterio",numOfA:0,price:{yellow:0,blue:0,orange:3,red:0,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Valkyrie",numOfA:1,price:{yellow:3,blue:0,orange:1,red:0,purple:1},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Kingpin",numOfA:0,price:{yellow:1,blue:0,orange:0,red:0,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Yondu",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:4},score:1,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Electro",numOfA:0,price:{yellow:0,blue:0,orange:2,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Bullseye",numOfA:0,price:{yellow:0,blue:1,orange:1,red:2,purple:1},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Grand Master",numOfA:0,price:{yellow:1,blue:1,orange:0,red:1,purple:1},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Spider Ham",numOfA:0,price:{yellow:1,blue:0,orange:0,red:0,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Silver Sable",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:3},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Wasp",numOfA:1,price:{yellow:2,blue:1,orange:2,red:0,purple:0},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Quake",numOfA:1,price:{yellow:0,blue:1,orange:3,red:0,purple:1},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Triton",numOfA:0,price:{yellow:1,blue:1,orange:1,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"America Chavez",numOfA:1,price:{yellow:1,blue:3,orange:0,red:1,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Kate Bishop",numOfA:1,price:{yellow:0,blue:1,orange:0,red:1,purple:3},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Moon Knight",numOfA:0,price:{yellow:3,blue:0,orange:0,red:0,purple:0},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Scorpion",numOfA:0,price:{yellow:0,blue:4,orange:0,red:0,purple:0},score:1,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Ms. Marvel",numOfA:1,price:{yellow:2,blue:0,orange:2,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Baron Zemo",numOfA:0,price:{yellow:0,blue:0,orange:0,red:3,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1}],de=[{name:"Hela",numOfA:0,price:{yellow:0,blue:6,orange:0,red:0,purple:0},score:3,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Cross Bones",numOfA:0,price:{yellow:4,blue:2,orange:1,red:0,purple:0},score:2,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Beta Ray Bill",numOfA:1,price:{yellow:0,blue:3,orange:2,red:3,purple:0},score:1,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Maximus",numOfA:0,price:{yellow:0,blue:2,orange:4,red:1,purple:0},score:2,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Quick Silver",numOfA:1,price:{yellow:2,blue:0,orange:0,red:3,purple:3},score:1,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Red Skull",numOfA:0,price:{yellow:0,blue:0,orange:6,red:0,purple:0},score:3,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Star Lord",numOfA:0,price:{yellow:0,blue:1,orange:2,red:4,purple:0},score:2,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"She Hulk",numOfA:1,price:{yellow:3,blue:0,orange:2,red:0,purple:2},score:1,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Okoye",numOfA:1,price:{yellow:3,blue:2,orange:0,red:0,purple:3},score:1,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Karnak",numOfA:0,price:{yellow:3,blue:0,orange:5,red:0,purple:0},score:2,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"The Collector",numOfA:0,price:{yellow:0,blue:0,orange:5,red:0,purple:0},score:2,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Medusa",numOfA:0,price:{yellow:0,blue:5,orange:3,red:0,purple:0},score:2,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Dare Devil",numOfA:0,price:{yellow:0,blue:0,orange:0,red:6,purple:0},score:3,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Miles Morales",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:5},score:2,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Black Cat",numOfA:0,price:{yellow:0,blue:0,orange:0,red:3,purple:5},score:2,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Scarlet Witch",numOfA:1,price:{yellow:2,blue:3,orange:0,red:2,purple:0},score:1,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Shuri",numOfA:1,price:{yellow:3,blue:2,orange:3,red:0,purple:0},score:1,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Nick Fury",numOfA:1,price:{yellow:0,blue:0,orange:3,red:3,purple:2},score:1,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Venom",numOfA:0,price:{yellow:0,blue:5,orange:0,red:0,purple:0},score:2,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Jessica Jones",numOfA:0,price:{yellow:6,blue:0,orange:0,red:0,purple:0},score:3,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Nebula",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:6},score:3,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Ghost Spider",numOfA:0,price:{yellow:0,blue:2,orange:1,red:0,purple:4},score:2,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Carnage",numOfA:0,price:{yellow:5,blue:0,orange:0,red:3,purple:0},score:2,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Ghost Rider",numOfA:0,price:{yellow:2,blue:4,orange:0,red:0,purple:1},score:2,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"War Machine",numOfA:1,price:{yellow:0,blue:2,orange:2,red:0,purple:3},score:1,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Ronan",numOfA:0,price:{yellow:5,blue:0,orange:0,red:0,purple:0},score:2,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Punisher",numOfA:0,price:{yellow:0,blue:0,orange:0,red:5,purple:0},score:2,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Falcon",numOfA:1,price:{yellow:3,blue:0,orange:0,red:3,purple:2},score:1,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Groot",numOfA:0,price:{yellow:0,blue:0,orange:0,red:5,purple:3},score:2,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Maria Hill",numOfA:1,price:{yellow:0,blue:2,orange:3,red:0,purple:2},score:1,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1}];function Se(){return{yellow:4,blue:4,orange:0,red:0,purple:0}}function be(){return{yellow:0,blue:0,orange:0,red:4,purple:4}}function Le(){return{yellow:4,blue:0,orange:4,red:0,purple:0}}function ve(){return{yellow:0,blue:0,orange:4,red:0,purple:4}}function Ge(){return{yellow:0,blue:4,orange:0,red:4,purple:0}}function Ne(){return{yellow:3,blue:0,orange:3,red:0,purple:3}}function Pe(){return{yellow:0,blue:3,orange:0,red:3,purple:3}}function Be(){return{yellow:3,blue:3,orange:0,red:3,purple:0}}const xe=[Se(),be(),Le(),ve(),Ge(),Ne(),Pe(),Be()];class Ue{tokens;city;people;tmp;coveredCards;hasA;isWinner;constructor(){this.tokens=new B,this.city=[],this.people=[],this.tmp=new B,this.coveredCards=[],this.hasA=!1,this.isWinner=!1}addCard(e){this.people.push(e)}getCardsCount(e){return this.people.filter(o=>o.color===e).length}getYellowCardsCount(){return this.people.filter(e=>e.color===r.YELLOW).length}getBlueCardsCount(){return this.people.filter(e=>e.color===r.BLUE).length}getOrangeCardsCount(){return this.people.filter(e=>e.color===r.ORANGE).length}getRedCardsCount(){return this.people.filter(e=>e.color===r.RED).length}getPurpleCardsCount(){return this.people.filter(e=>e.color===r.PURPLE).length}showCity1(){return this.city.length>=1}showCity2(){return this.city.length>=2}showCity3(){return this.city.length>=3}showCity4(){return this.city.length>=4}showGreen(){return this.people.some(e=>e.levelColor===s.BLUE)}getScores(){const e=this.people.reduce((i,n)=>i+n.score,0),o=this.city.length*3,t=this.hasA?3:0;return e+o+t}getNumOfA(){return this.people.reduce((e,o)=>e+o.numOfA,0)}canWin(){return this.people.some(e=>e.color===r.YELLOW)&&this.people.some(e=>e.color===r.BLUE)&&this.people.some(e=>e.color===r.ORANGE)&&this.people.some(e=>e.color===r.RED)&&this.people.some(e=>e.color===r.PURPLE)&&this.showGreen()&&this.getScores()>=16}isClean(){return this.tokens.equals(new B)&&this.city.length===0&&this.people.length===0&&this.coveredCards.length===0}}class We{x;y;size;angle=0;targetAngle=0;cornerIndex=0;bounce=0;constructor(e,o,t=48){this.x=e,this.y=o,this.size=t}resetCornerIndex(){this.cornerIndex=0}pointTo(e,o){const t=e.length;o&&(this.cornerIndex=(this.cornerIndex+1)%t);const i=e[this.cornerIndex].x,n=e[this.cornerIndex].y;this.targetAngle=Math.atan2(n-this.y,i-this.x),this.bounce=1}draw(e){const o=this.x,t=this.y;this.angle=this.targetAngle,e.save(),e.translate(o,t),e.rotate(this.angle),e.font=`${this.size}px serif`,e.textAlign="center",e.textBaseline="middle",e.fillText("âžœ",0,0),e.restore()}contains(e,o){const t=e-this.x,i=o-this.y,n=Math.cos(-this.angle),c=Math.sin(-this.angle),u=t*n-i*c,a=t*c+i*n,d=this.size*.5;return u>=-d&&u<=d&&a>=-d&&a<=d}}let oe=0;function Te(l){oe=l}let R=2;function Ye(l){R=l}let C=[];function Ie(l){C=l}let P=new B;function Me(l){P=l}let S=null;function F(l){S=l}let he=[];function De(l){he=l}let fe=[];function He(l){fe=l}let pe=[];function ze(l){pe=l}let D=[];function je(l){D=l}class Ee{city;width;height;x;y;constructor(e,o,t,i,n){this.city=e,this.x=o,this.y=t,this.width=i,this.height=n}draw(e){if(this.city===null)return;e.fillStyle="#fff",e.fillRect(this.x,this.y,this.width,this.height),e.strokeStyle="black",e.strokeRect(this.x,this.y,this.width,this.height);const o=this.width*4/9,t=this.height*4/9,i=t/9,n=Object.entries(this.city).filter(([a,d])=>d>0).slice(0,3),c=this.y+i,u=c+t+i;n.forEach(([a,d],g)=>{let A=0,w=0;if(g===0)A=this.x+this.width/2-o/2,w=c;else if(g===1&&n.length===2)A=this.x+this.width/2-o/2,w=u;else{const L=g===1?i:i*2+o;A=this.x+L,w=u}e.fillStyle=ie[a],e.fillRect(A,w,o,t),e.strokeStyle="black",e.strokeRect(A,w,o,t),e.fillStyle="black",e.font=`${t-4}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(String(d),A+o/2,w+t/2+t*.05)})}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}class T{img;path;width;height;x;y;constructor(e,o,t,i,n,c){this.path=e,this.x=o,this.y=t,this.width=i,this.height=n,e&&(this.img=new Image,this.img.onload=c,this.img.src=e)}draw(e){if(!this.img||!this.img.complete)return;const o=Math.min(this.width/this.img.width,this.height/this.img.height),t=this.img.width*o,i=this.img.height*o,n=this.x+(this.width-t)/2,c=this.y+(this.height-i)/2;e.drawImage(this.img,n,c,t,i)}}class v{text;color;x;y;r;width;height;isRect;show;constructor(e,o,t,i,n,c,u,a,d=!0){this.text=e,this.color=o,this.x=t,this.y=i,this.r=n,this.width=c,this.height=u,this.isRect=a,this.show=d}draw(e){let o=0,t=0,i=0;e.fillStyle=this.show?this.color:Q,e.strokeStyle=this.show?"black":Q,this.isRect?(e.fillRect(this.x,this.y,this.width,this.height),e.strokeRect(this.x,this.y,this.width,this.height),o=this.height,t=this.width/2,i=this.height/2):(e.beginPath(),e.arc(this.x+this.r,this.y+this.r,this.r,0,Math.PI*2),e.fill(),e.stroke(),o=this.r*2,t=this.r,i=this.r),this.show&&(e.fillStyle="black",e.font=`${o-4}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(this.text,this.x+t,this.y+i+i*2*.05))}contains(e,o){const t=this.isRect?this.width:this.r*2,i=this.isRect?this.height:this.r*2;return e>=this.x&&e<=this.x+t&&o>=this.y&&o<=this.y+i}}class ge{text;width;height;x;y;constructor(e,o,t,i,n){this.text=e,this.x=o,this.y=t,this.width=i,this.height=n}draw(e){let o=this.height/2;e.fillStyle="black",e.font=`${o}px Arial`,e.textAlign="start",e.textBaseline="middle",e.fillText(this.text,this.x,this.y+o+o*2*.05)}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}const V=[{id:"action_reset",icon:"ðŸ”„",title:"Reset",action:()=>{le()}},{id:"action_add_player",icon:"ðŸ‘«",title:"Add Player",action:()=>{Ye(R===2?3:R===3?4:2),le()}},{id:"action_manual",icon:"ðŸ“–",title:"Manual",action:()=>{const l=["./assets/manual1.png","./assets/manual2.png","./assets/manual3.png","./assets/manual4.png"],e=window.open("","_blank");if(e){const o=e.document.head,t=e.document.createElement("title");t.textContent="Manual",o.appendChild(t);const i=e.document.createElement("link");i.rel="icon",i.href="./assets/favicon.png",i.type="image/png",o.appendChild(i);const n=e.document.createElement("style");n.textContent=`
                body {
                    margin: 0;
                    padding: 20px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    background: #f0f0f0;
                }
                img {
                    max-width: 80%;
                    margin-bottom: 20px;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                    border-radius: 8px;
                }
            `,o.appendChild(n);const c=e.document.body;l.forEach(u=>{const a=e.document.createElement("img");a.src=u,c.appendChild(a)})}}},{id:"action_show_people",icon:"âœ‹",title:"show people",action:()=>{Je()}}];function _(l){const e=[...l];for(let o=e.length-1;o>0;o--){const t=Math.floor(Math.random()*(o+1));[e[o],e[t]]=[e[t],e[o]]}return e}function Fe(){return De(_(ae)),He(_(de)),ze(_(ue)),[{backStack:he,closeCard:new J(null,s.BLUE,0,0,0,0,0),openCards:[],color:s.BLUE,y:0},{backStack:fe,closeCard:new J(null,s.ORANGE,0,0,0,0,0),openCards:[],color:s.ORANGE,y:0},{backStack:pe,closeCard:new J(null,s.GREEN,0,0,0,0,0),openCards:[],color:s.GREEN,y:0}]}function _e(){je(_(xe).slice(0,R))}function Xe(){const e=7-(R===2?3:R===3?2:0);Me(new B({[h.YELLOW]:e,[h.BLUE]:e,[h.ORANGE]:e,[h.RED]:e,[h.PURPLE]:e,[h.GRAY]:5}))}function $e(){return Ie(Array.from({length:R},()=>new Ue)),Array.from({length:R},()=>({people:[],tokens:[],green:new v("G","#0f0",0,0,0,0,0,!1,!1),tmpTokens:[],scores:new ge("",0,0,0,0),cities:[],a:new T("",0,0,0,0,null),btnIn:new v("IN","#0f0",0,0,0,0,0,!0,!1),btnOut:new v("OUT","#0ff",0,0,0,0,0,!0,!1),showFirst:new T("",0,0,0,0,null),showWinner:new T("",0,0,0,0,null),coveredCards:[]}))}function Ke(l,e){Qe(l,e),Ze(l,e),Ve(l,e),el(l,e),ll(l,e),rl(l,e),tl(l,e),nl(l,e),se()}function G(){F(null),ae.forEach(l=>l.isSelected=!1),de.forEach(l=>l.isSelected=!1),ue.forEach(l=>l.isSelected=!1),C.forEach(l=>{l.coveredCards.forEach(e=>e.isSelected=!1)})}function qe(l){const e=p.cornerIndex,o=C[e].tmp.tokens;if(o[h.GRAY]!==0)return!1;if(l===h.GRAY)return Object.entries(o).filter(([a])=>a!==l.toString()).reduce((a,[,d])=>a+d,0)==0&&C[e].coveredCards.length<3;const t=Object.entries(o).filter(([c])=>c!==l.toString()&&l!==h.GRAY.toString());if(t.some(([,c])=>c===2))return!1;const n=t.reduce((c,[,u])=>c+u,0);return o[l]===0?n<=2:o[l]===1?n===0&&P.tokens[l]>=3:!1}function Je(){const l=window.open("show_people.html","hand");setTimeout(()=>{l?.postMessage({type:"HAND_UPDATE",players:C},"*")},300)}function Qe(l,e){V.forEach(o=>{o.x<=l&&l<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&o.action()})}function Ze(l,e){Y.forEach(o=>{if(o.contains(l,e)){const t=o.color;P.tokens[t]>0&&(qe(t)?(P.tokens[t]--,o.value=P.tokens[t],C[p.cornerIndex].tmp.tokens[t]++):(q(),G()))}})}function Ve(l,e){I.forEach(o=>{const t=o.closeCard,i=t.contains(l,e);i&&t.card!==null&&(G(),t.card.isSelected=i,F(t.card)),o.openCards.forEach(n=>{n.contains(l,e)&&n.card!==null&&(G(),n.card.isSelected=!0,F(n.card))})}),M.forEach((o,t)=>{t===p.cornerIndex&&o.coveredCards.forEach(i=>{i.contains(l,e)&&i.card!==null&&(G(),i.card.isSelected=!0,F(i.card))})})}function H(){const l=ke();p.pointTo(l,!0)}function me(){let l=!0;C.forEach(e=>{e.isClean()||(l=!1)}),l&&Te(p.cornerIndex)}function el(l,e){M.forEach((o,t)=>{o.btnIn.contains(l,e)?Oe(t):o.btnOut.contains(l,e)&&Ae(t)})}function ll(l,e){K.forEach((o,t)=>{if(o.contains(l,e))for(let i=0;i<=R;i++)ye(i,t,!0)})}function ol(l){const e=C[p.cornerIndex];e.tokens.tokens[l]--,e.tmp.tokens[l]++}function rl(l,e){M.forEach(o=>{o.tokens.forEach(t=>{t.contains(l,e)&&ol(t.color)})})}function tl(l,e){p.contains(l,e)&&(H(),me())}function nl(l,e){let o=b;o.x<=l&&l<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&Oe(p.cornerIndex),o=U,o.x<=l&&l<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&Ae(p.cornerIndex)}function re(){const l=C[p.cornerIndex],e=l.tmp.tokens,o=l.tokens.tokens;for(const t of Object.values(h))o[t]+=e[t];l.tmp=new B}function q(){const l=C[p.cornerIndex],e=l.tmp.tokens,o=P.tokens;for(const t of Object.values(h))o[t]+=e[t];l.tmp=new B}function sl(){confirm("é€€éŒ¯è«‹æŒ‰ã€Œç¢ºå®šã€æ”¶å›žï¼›ä¸èƒ½ç›´æŽ¥æ‹¿ï¼è«‹æŒ‰ã€Œå–æ¶ˆã€é‚„éŠ€è¡Œ")?re():(q(),G())}function il(){confirm("ç¢ºå®šä¸æ‹¿ç°è‰²ï¼Ÿ")&&C[p.cornerIndex].coveredCards.length<3&&te()}function cl(){confirm("ä¸èƒ½è²·ï¼Œæ˜¯å¦æ”¶å…¥è“‹ç‰Œä¸­ï¼Ÿ")&&C[p.cornerIndex].coveredCards.length<3&&te()}function Ce(){I.forEach(l=>{let e=l.closeCard.card;e!==null&&e==S&&(e=l.backStack.shift()??null),l.openCards.forEach(o=>{if(o.card!==null&&o.card==S){const t=l.backStack.shift()??null;o.card=t}})})}function te(){const l=p.cornerIndex,e=C[l];S!==null&&e.coveredCards.push(S),re(),Ce(),G();const o=e.showGreen()?1:0;Object.entries(e.tokens.tokens).reduce((i,[,n])=>i+n,0)+o<=10&&($(l),H())}function al(l,e,o,t,i){if(S===null)return;const n=l+e+o+t+i,c=S,u=C[p.cornerIndex],a=u.tokens.tokens,d=Math.max(c.price[r.YELLOW]-u.getYellowCardsCount(),0),g=Math.max(c.price[r.BLUE]-u.getBlueCardsCount(),0),A=Math.max(c.price[r.ORANGE]-u.getOrangeCardsCount(),0),w=Math.max(c.price[r.RED]-u.getRedCardsCount(),0),L=Math.max(c.price[r.PURPLE]-u.getPurpleCardsCount(),0);a[h.YELLOW]-=d,a[h.YELLOW]=Math.max(a[h.YELLOW],0),a[h.BLUE]-=g,a[h.BLUE]=Math.max(a[h.BLUE],0),a[h.ORANGE]-=A,a[h.ORANGE]=Math.max(a[h.ORANGE],0),a[h.RED]-=w,a[h.RED]=Math.max(a[h.RED],0),a[h.PURPLE]-=L,a[h.PURPLE]=Math.max(a[h.PURPLE],0),a[h.GRAY]-=n;const k=P.tokens;k[h.YELLOW]+=d-l,k[h.BLUE]+=g-e,k[h.ORANGE]+=A-o,k[h.RED]+=w-t,k[h.PURPLE]+=L-i,k[h.GRAY]+=n}function we(){const l=C.find(t=>t.hasA),e=C.filter(t=>t.getNumOfA()>=3).sort((t,i)=>i.getNumOfA()-t.getNumOfA());if(e.length===0)return;const o=e[0];if(!l){o.hasA=!0;return}o.getNumOfA()>l.getNumOfA()&&(l.hasA=!1,o.hasA=!0)}function ul(){const l=p.cornerIndex,e=C[l],o=[];D.forEach((i,n)=>{i!==null&&i[r.YELLOW]<=e.getYellowCardsCount()&&i[r.BLUE]<=e.getBlueCardsCount()&&i[r.ORANGE]<=e.getOrangeCardsCount()&&i[r.RED]<=e.getRedCardsCount()&&i[r.PURPLE]<=e.getPurpleCardsCount()&&o.push(n)});const t=o.length;return t===0?(we(),!0):t===1?(ye(l,o[0]),!0):(alert("è«‹é¸ä¸€å¼µåŸŽå¸‚å¡"),!1)}function ye(l,e,o=!1){if(p.cornerIndex!==l)return;const i=C[l];let n=D[e];n!==null&&n[r.YELLOW]<=i.getYellowCardsCount()&&n[r.BLUE]<=i.getBlueCardsCount()&&n[r.ORANGE]<=i.getOrangeCardsCount()&&n[r.RED]<=i.getRedCardsCount()&&n[r.PURPLE]<=i.getPurpleCardsCount()&&(i.city.push(n),D[e]=null),we(),o&&($(l),H())}function Oe(l){if(p.cornerIndex!==l)return;const e=C[l],o=e.tokens.tokens,t=e.tmp.tokens;if(t[h.GRAY]!==0)if(S===null||e.coveredCards.some(c=>c.name===S?.name)){sl();return}else{te();return}const n=Object.entries(t).filter(([c])=>c!==h.GRAY.toString()).reduce((c,[,u])=>c+u,0);if(S==null)if(n>0){re();const c=e.showGreen()?1:0;Object.entries(o).reduce((a,[,d])=>a+d,0)+c<=10&&($(l),H())}else return;else if(n>0)q(),G();else{if(e.coveredCards.length<3&&I.some(y=>y.closeCard.card==S)){il();return}const c=S,u=e.getYellowCardsCount()+o[h.YELLOW],a=e.getBlueCardsCount()+o[h.BLUE],d=e.getOrangeCardsCount()+o[h.ORANGE],g=e.getRedCardsCount()+o[h.RED],A=e.getPurpleCardsCount()+o[h.PURPLE],w=c.price[r.YELLOW]>u?c.price[r.YELLOW]-u:0,L=c.price[r.BLUE]>a?c.price[r.BLUE]-a:0,k=c.price[r.ORANGE]>d?c.price[r.ORANGE]-d:0,z=c.price[r.RED]>g?c.price[r.RED]-g:0,j=c.price[r.PURPLE]>A?c.price[r.PURPLE]-A:0,x=w+L+k+z+j;if(o[h.GRAY]>=x){if(al(w,L,k,z,j),e.addCard(c),e.coveredCards.some(O=>O.name===c.name)){const O=e.coveredCards.findIndex(N=>N.name===c.name);O!==-1&&e.coveredCards.splice(O,1)}else Ce();ul()&&($(l),H())}else{cl();return}G()}}function Ae(l){p.cornerIndex===l&&(q(),G())}function $(l){if(l!==(R-1+oe)%R)return;if(Array.from({length:R},(c,u)=>C[u].canWin())[l]){C[l].isWinner=!0;return}const o=C.filter(c=>c.canWin());if(o.length===0)return;const t=o.sort((c,u)=>u.getScores()-c.getScores()),i=t.filter(c=>c.getScores()===t[0].getScores());if(i.length===1){i[0].isWinner=!0;return}console.log("===Blaze=== 5");const n=i.find(c=>c.hasA);if(n)n.isWinner=!0;else{const c=i.sort((a,d)=>a.people.length-d.people.length);c.filter(a=>a.people.length===c[0].people.length).forEach(a=>a.isWinner=!0)}}let I=[],K=[],Y=[],M=[];const p=new We(200,200,48),b=new v("IN","#0f0",0,0,0,400,200,!0,!0),U=new v("OUT","#0ff",0,0,0,400,200,!0,!0),m=document.getElementById("canvas"),E=m.getContext("2d"),f=10,dl=1/25,hl=1/50,fl=1/50,pl=1/40,El=1/40;let ee=0,ne=0,Re=0;function gl(){const l=m.width*dl,e=l*2,o=l+f,t=m.width/2-l*1.5-f*1;ne=t+l*4+f*3;const i=(m.height-W)/2-e*1.5-f;ee=i,I.forEach((n,c)=>{if(n.y=i+c*(e+f),n.openCards.length===0)for(let a=0;a<4;a++){const d=n.backStack.shift()??null;n.openCards.push(new ce(d,n.color,t+a*o,n.y,l,e))}else n.openCards.forEach((a,d)=>{a.x=t+d*o,a.y=n.y,a.width=l,a.height=e});const u=n.backStack.length;n.closeCard.card=u>0?n.backStack[0]:null,n.closeCard.cardLeft=u,n.closeCard.x=t-o,n.closeCard.y=n.y,n.closeCard.width=l,n.closeCard.height=e})}function ml(){const l=m.width*hl,e=l,o=l+f,t=ne+f;Re=ee+2*e+f,K=[],D.forEach((i,n)=>{const c=n%2,u=n<2?0:1;K.push(new Ee(i,t+c*o,ee+u*(e+f),l,e))})}function Cl(){const l=m.width*pl/2,e=l*2+f,o=ne+f,t=Re+f;Y=[],Object.values(h).forEach((i,n)=>{const c=n%2,u=Math.floor(n/2);Y.push(new Z(P.tokens[i],i,o+c*e,t+u*e,l))})}function wl(){const l=m.width*fl,e=l*6+f*4,o=.8,t=f+(l+f)*8+(l*o+f)*3,i=4;M.forEach((n,c)=>{const u=C[c],a=c<2?f:m.width-f-t;let d=a+l,g=c===0||c===3?m.height-f-l:W+f+e;const A=c===0||c===3?g-e*2:g+l;let w=u.isWinner?"./assets/thanos.webp":"";const L=Math.min(t,e);n.showWinner=new T(w,a,A,L,L,X),n.btnIn=new v("IN","#0f0",d,g,0,l*2,l,!0,!0),d+=l*2+f*2,n.btnOut=new v("OUT","#0ff",d,g,0,l*2,l,!0,!0),d+=l*2+f*2,w=oe===c?"./assets/first.png":"",n.showFirst=new T(w,d,g,l*2,l,X),g-=l+f,d=a,n.scores=new ge(`åˆ†ï¼š${u.getScores()} Aï¼š${u.getNumOfA()}`,d,g,l*4,l),d+=n.scores.width+f,u.city.forEach((y,O)=>{const N=new Ee(y,d+O*(l+f),g,l,l);n.cities.push(N)});const k=u.city.length;let z=Array.from({length:i-k},(y,O)=>new v("",Q,d+(k+O)*(l+f),g,0,l,l,!0,!1));n.cities.push(...z),d+=i*(l+f),w=u.hasA?"./assets/marvel_a.png":"",n.a=new T(w,d,g,l,l,X),g-=l+f,d=a,n.tokens=[],Object.values(h).forEach(y=>{n.tokens.push(new Z(u.tokens.tokens[y],y,d,g,l/2)),d+=l+f});const j=u.showGreen();n.green=new v("G","#0F0",d,g,l/2,0,0,!1,j),d+=(l+f)*2,n.tmpTokens=[],Object.values(h).forEach(y=>{const O=u.tmp.tokens[y],N=n.tmpTokens.length;O>0&&n.tmpTokens.push(new Z(O,y,d+N*(l*.8+f),g,l*o/2))}),d=a,g-=l+f,n.people=[],Object.values(r).forEach((y,O)=>{const N=u.getCardsCount(y);n.people.push(new v(String(N),ie[y],d+O*(l+f),g,0,l,l,!0,N>0))});const x=l*1.5;g-=x*2+f,n.coveredCards=[],u.coveredCards.forEach((y,O)=>{n.coveredCards.push(new ce(y,y.color,d+O*(x+f),g,x,x*2))})})}function yl(){const l=Y[Y.length-1];p.size=m.width*El,p.x=l.x,p.y=l.y+l.r*2+f+p.size}function Ol(){b.x=p.x-p.size,b.y=p.y+p.size+f,b.width=p.size*2,b.height=p.size,U.x=b.x,U.y=b.y+b.height+f,U.width=b.width,U.height=b.height}const W=30;function Al(){const l=m.width/V.length;V.forEach((e,o)=>{const t=o*l,i=0;e.x=t,e.y=i,e.width=l,e.height=W,E.fillStyle="#fff",E.fillRect(t+2,i,l-4,W),E.font="20px Arial",E.textAlign="center",E.textBaseline="middle",E.fillStyle="#000",E.fillText(e.icon,t+l/2-30,W/2),E.font="16px Arial",E.fillText(e.title,t+l/2+30,W/2)})}function Rl(){I.forEach(l=>{l.closeCard.draw(E),l.openCards.forEach(e=>e.draw(E))})}function kl(){K.forEach(l=>l.draw(E))}function Sl(){Y.forEach(l=>l.draw(E))}function X(){M.forEach(l=>{l.people.forEach(e=>e.draw(E)),l.tokens.forEach(e=>e.draw(E)),l.green.draw(E),l.tmpTokens.forEach(e=>e.draw(E)),l.scores.draw(E),l.cities.forEach(e=>e.draw(E)),l.a.draw(E),l.btnIn.draw(E),l.btnOut.draw(E),l.showFirst.draw(E),l.coveredCards.forEach(e=>e.draw(E)),l.showWinner.draw(E)})}function ke(){return[{x:0,y:m.height},{x:0,y:0},{x:m.width,y:0},{x:m.width,y:m.height}].slice(0,R)}function bl(){const l=ke();p.pointTo(l,!1),p.draw(E)}function Ll(){b.draw(E),U.draw(E)}function se(){E.clearRect(0,0,m.width,m.height),Al(),gl(),Rl(),ml(),kl(),Cl(),Sl(),wl(),X(),yl(),bl(),Ol(),Ll()}function le(){m.width=window.innerWidth,m.height=window.innerHeight,I=Fe(),_e(),Xe(),M=$e(),p.resetCornerIndex(),me(),se()}function vl(){m.width=window.innerWidth,m.height=window.innerHeight,se()}m.addEventListener("click",l=>{const e=m.getBoundingClientRect(),o=l.clientX-e.left,t=l.clientY-e.top;Ke(o,t)});window.addEventListener("resize",vl);le();
