import{L as s,C as r,T as W,c as se,t as oe,a as h,b as he,d as re}from"./card_open-Cf0icbjT.js";const fe=[{name:"Hulk",numOfA:2,price:{yellow:0,blue:3,orange:5,red:3,purple:3},score:3,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Spider Man",numOfA:0,price:{yellow:7,blue:0,orange:0,red:3,purple:0},score:5,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Green Goblin",numOfA:0,price:{yellow:0,blue:7,orange:0,red:0,purple:3},score:5,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Doctor Octopus",numOfA:0,price:{yellow:0,blue:7,orange:0,red:0,purple:0},score:4,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Vision",numOfA:1,price:{yellow:3,blue:6,orange:0,red:3,purple:0},score:4,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Doctor Strange",numOfA:1,price:{yellow:0,blue:0,orange:0,red:0,purple:7},score:4,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Captain Marvel",numOfA:1,price:{yellow:0,blue:3,orange:6,red:0,purple:3},score:4,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Iron Fist",numOfA:0,price:{yellow:0,blue:0,orange:0,red:7,purple:0},score:4,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Thor",numOfA:2,price:{yellow:3,blue:3,orange:0,red:3,purple:5},score:3,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Loki",numOfA:0,price:{yellow:0,blue:3,orange:0,red:0,purple:7},score:5,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Gamora",numOfA:0,price:{yellow:0,blue:0,orange:3,red:7,purple:0},score:5,color:r.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Ant Man",numOfA:1,price:{yellow:3,blue:0,orange:3,red:6,purple:0},score:4,color:r.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Drax",numOfA:0,price:{yellow:0,blue:0,orange:7,red:0,purple:0},score:4,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Luke Cage",numOfA:0,price:{yellow:3,blue:0,orange:7,red:0,purple:0},score:5,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Captain America",numOfA:2,price:{yellow:5,blue:3,orange:3,red:0,purple:3},score:3,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Black Widow",numOfA:2,price:{yellow:3,blue:3,orange:0,red:5,purple:3},score:3,color:r.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Nova",numOfA:0,price:{yellow:0,blue:0,orange:3,red:3,purple:6},score:4,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Black Bolt",numOfA:0,price:{yellow:7,blue:0,orange:0,red:0,purple:0},score:4,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Iron Man",numOfA:2,price:{yellow:3,blue:5,orange:3,red:3,purple:0},score:3,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Black Panther",numOfA:1,price:{yellow:6,blue:0,orange:3,red:0,purple:3},score:4,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1}];class te{card;color;cardLeft;x;y;width;height;constructor(e,o,l,i,n,c,a){this.card=e,this.color=o,this.cardLeft=l,this.x=i,this.y=n,this.width=c,this.height=a}draw(e){this.card!==null&&(e.fillStyle=this.color,e.fillRect(this.x,this.y,this.width,this.height),e.lineWidth=this.card.isSelected?5:1,e.strokeStyle=this.card.isSelected?"red":"black",e.strokeRect(this.x,this.y,this.width,this.height),e.fillStyle="white",e.font="20px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(`${this.cardLeft}`,this.x+this.width/2,this.y+this.height/2)),e.lineWidth=1}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}const pe=[{name:"Prowler",numOfA:0,price:{yellow:0,blue:1,orange:1,red:2,purple:1},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Wong",numOfA:0,price:{yellow:1,blue:1,orange:2,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Modok",numOfA:0,price:{yellow:0,blue:0,orange:2,red:2,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Rocket",numOfA:0,price:{yellow:1,blue:0,orange:0,red:2,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Abomination",numOfA:0,price:{yellow:0,blue:2,orange:1,red:1,purple:1},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Gorgon",numOfA:0,price:{yellow:2,blue:2,orange:0,red:0,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Kraven",numOfA:0,price:{yellow:0,blue:3,orange:0,red:0,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Spider Woman",numOfA:1,price:{yellow:1,blue:1,orange:0,red:3,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Spider Man 2099",numOfA:0,price:{yellow:2,blue:0,orange:0,red:1,purple:0},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Sand Man",numOfA:0,price:{yellow:0,blue:0,orange:4,red:0,purple:0},score:1,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Crystal",numOfA:0,price:{yellow:0,blue:0,orange:2,red:0,purple:2},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Winter Soldier",numOfA:1,price:{yellow:0,blue:2,orange:1,red:2,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Rhino",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Squirrel Girl",numOfA:1,price:{yellow:0,blue:0,orange:1,red:2,purple:2},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Task Master",numOfA:0,price:{yellow:4,blue:0,orange:0,red:0,purple:0},score:1,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Elektra",numOfA:0,price:{yellow:2,blue:0,orange:0,red:0,purple:2},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Vulture",numOfA:0,price:{yellow:0,blue:0,orange:0,red:4,purple:0},score:1,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Scarlet Spider",numOfA:0,price:{yellow:0,blue:1,orange:1,red:1,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Spider Girl",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Lockjaw",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Lizard",numOfA:0,price:{yellow:0,blue:2,orange:0,red:0,purple:1},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Hawkeye",numOfA:1,price:{yellow:1,blue:2,orange:0,red:0,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Mysterio",numOfA:0,price:{yellow:0,blue:0,orange:3,red:0,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Valkyrie",numOfA:1,price:{yellow:3,blue:0,orange:1,red:0,purple:1},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Kingpin",numOfA:0,price:{yellow:1,blue:0,orange:0,red:0,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Yondu",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:4},score:1,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Electro",numOfA:0,price:{yellow:0,blue:0,orange:2,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Bullseye",numOfA:0,price:{yellow:0,blue:1,orange:1,red:2,purple:1},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Grand Master",numOfA:0,price:{yellow:1,blue:1,orange:0,red:1,purple:1},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Spider Ham",numOfA:0,price:{yellow:1,blue:0,orange:0,red:0,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Silver Sable",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:3},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Wasp",numOfA:1,price:{yellow:2,blue:1,orange:2,red:0,purple:0},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Quake",numOfA:1,price:{yellow:0,blue:1,orange:3,red:0,purple:1},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Triton",numOfA:0,price:{yellow:1,blue:1,orange:1,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"America Chavez",numOfA:1,price:{yellow:1,blue:3,orange:0,red:1,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Kate Bishop",numOfA:1,price:{yellow:0,blue:1,orange:0,red:1,purple:3},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Moon Knight",numOfA:0,price:{yellow:3,blue:0,orange:0,red:0,purple:0},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Scorpion",numOfA:0,price:{yellow:0,blue:4,orange:0,red:0,purple:0},score:1,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Ms. Marvel",numOfA:1,price:{yellow:2,blue:0,orange:2,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Baron Zemo",numOfA:0,price:{yellow:0,blue:0,orange:0,red:3,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1}],Ee=[{name:"Hela",numOfA:0,price:{yellow:0,blue:6,orange:0,red:0,purple:0},score:3,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Cross Bones",numOfA:0,price:{yellow:4,blue:2,orange:1,red:0,purple:0},score:2,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Beta Ray Bill",numOfA:1,price:{yellow:0,blue:3,orange:2,red:3,purple:0},score:1,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Maximus",numOfA:0,price:{yellow:0,blue:2,orange:4,red:1,purple:0},score:2,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Quick Silver",numOfA:1,price:{yellow:2,blue:0,orange:0,red:3,purple:3},score:1,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Red Skull",numOfA:0,price:{yellow:0,blue:0,orange:6,red:0,purple:0},score:3,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Star Lord",numOfA:0,price:{yellow:0,blue:1,orange:2,red:4,purple:0},score:2,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"She Hulk",numOfA:1,price:{yellow:3,blue:0,orange:2,red:0,purple:2},score:1,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Okoye",numOfA:1,price:{yellow:3,blue:2,orange:0,red:0,purple:3},score:1,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Karnak",numOfA:0,price:{yellow:3,blue:0,orange:5,red:0,purple:0},score:2,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"The Collector",numOfA:0,price:{yellow:0,blue:0,orange:5,red:0,purple:0},score:2,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Medusa",numOfA:0,price:{yellow:0,blue:5,orange:3,red:0,purple:0},score:2,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Dare Devil",numOfA:0,price:{yellow:0,blue:0,orange:0,red:6,purple:0},score:3,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Miles Morales",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:5},score:2,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Black Cat",numOfA:0,price:{yellow:0,blue:0,orange:0,red:3,purple:5},score:2,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Scarlet Witch",numOfA:1,price:{yellow:2,blue:3,orange:0,red:2,purple:0},score:1,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Shuri",numOfA:1,price:{yellow:3,blue:2,orange:3,red:0,purple:0},score:1,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Nick Fury",numOfA:1,price:{yellow:0,blue:0,orange:3,red:3,purple:2},score:1,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Venom",numOfA:0,price:{yellow:0,blue:5,orange:0,red:0,purple:0},score:2,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Jessica Jones",numOfA:0,price:{yellow:6,blue:0,orange:0,red:0,purple:0},score:3,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Nebula",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:6},score:3,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Ghost Spider",numOfA:0,price:{yellow:0,blue:2,orange:1,red:0,purple:4},score:2,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Carnage",numOfA:0,price:{yellow:5,blue:0,orange:0,red:3,purple:0},score:2,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Ghost Rider",numOfA:0,price:{yellow:2,blue:4,orange:0,red:0,purple:1},score:2,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"War Machine",numOfA:1,price:{yellow:0,blue:2,orange:2,red:0,purple:3},score:1,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Ronan",numOfA:0,price:{yellow:5,blue:0,orange:0,red:0,purple:0},score:2,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Punisher",numOfA:0,price:{yellow:0,blue:0,orange:0,red:5,purple:0},score:2,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Falcon",numOfA:1,price:{yellow:3,blue:0,orange:0,red:3,purple:2},score:1,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Groot",numOfA:0,price:{yellow:0,blue:0,orange:0,red:5,purple:3},score:2,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Maria Hill",numOfA:1,price:{yellow:0,blue:2,orange:3,red:0,purple:2},score:1,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1}];function Ge(){return{yellow:4,blue:4,orange:0,red:0,purple:0}}function Ne(){return{yellow:0,blue:0,orange:0,red:4,purple:4}}function Pe(){return{yellow:4,blue:0,orange:4,red:0,purple:0}}function Be(){return{yellow:0,blue:0,orange:4,red:0,purple:4}}function Ue(){return{yellow:0,blue:4,orange:0,red:4,purple:0}}function xe(){return{yellow:3,blue:0,orange:3,red:0,purple:3}}function We(){return{yellow:0,blue:3,orange:0,red:3,purple:3}}function Te(){return{yellow:3,blue:3,orange:0,red:3,purple:0}}const Ye=[Ge(),Ne(),Pe(),Be(),Ue(),xe(),We(),Te()];class Ie{tokens;city;people;tmp;coveredCards;hasA;isWinner;constructor(){this.tokens=new W,this.city=[],this.people=[],this.tmp=new W,this.coveredCards=[],this.hasA=!1,this.isWinner=!1}addCard(e){this.people.push(e)}getCardsCount(e){return this.people.filter(o=>o.color===e).length}getYellowCardsCount(){return this.people.filter(e=>e.color===r.YELLOW).length}getBlueCardsCount(){return this.people.filter(e=>e.color===r.BLUE).length}getOrangeCardsCount(){return this.people.filter(e=>e.color===r.ORANGE).length}getRedCardsCount(){return this.people.filter(e=>e.color===r.RED).length}getPurpleCardsCount(){return this.people.filter(e=>e.color===r.PURPLE).length}showCity1(){return this.city.length>=1}showCity2(){return this.city.length>=2}showCity3(){return this.city.length>=3}showCity4(){return this.city.length>=4}showGreen(){return this.people.some(e=>e.levelColor===s.BLUE)}getScores(){const e=this.people.reduce((i,n)=>i+n.score,0),o=this.city.length*3,l=this.hasA?3:0;return e+o+l}getNumOfA(){return this.people.reduce((e,o)=>e+o.numOfA,0)}canWin(){return this.people.some(e=>e.color===r.YELLOW)&&this.people.some(e=>e.color===r.BLUE)&&this.people.some(e=>e.color===r.ORANGE)&&this.people.some(e=>e.color===r.RED)&&this.people.some(e=>e.color===r.PURPLE)&&this.showGreen()&&this.getScores()>=16}isClean(){return this.tokens.equals(new W)&&this.city.length===0&&this.people.length===0&&this.coveredCards.length===0}}class Me{x;y;size;angle=0;targetAngle=0;cornerIndex=0;bounce=0;constructor(e,o,l=48){this.x=e,this.y=o,this.size=l}resetCornerIndex(){this.cornerIndex=0}pointTo(e,o){const l=e.length;o&&(this.cornerIndex=(this.cornerIndex+1)%l);const i=e[this.cornerIndex].x,n=e[this.cornerIndex].y;this.targetAngle=Math.atan2(n-this.y,i-this.x),this.bounce=1}draw(e){const o=this.x,l=this.y;this.angle=this.targetAngle,e.save(),e.translate(o,l),e.rotate(this.angle),e.font=`${this.size}px serif`,e.textAlign="center",e.textBaseline="middle",e.fillText("âžœ",0,0),e.restore()}contains(e,o){const l=e-this.x,i=o-this.y,n=Math.cos(-this.angle),c=Math.sin(-this.angle),a=l*n-i*c,d=l*c+i*n,u=this.size*.5;return a>=-u&&a<=u&&d>=-u&&d<=u}}let ie=0;function De(t){ie=t}let k=2;function _e(t){k=t}let C=[];function je(t){C=t}let B=new W;function He(t){B=t}let S=null;function $(t){S=t}let ge=[];function ze(t){ge=t}let me=[];function Fe(t){me=t}let we=[];function Xe(t){we=t}let H=[];function $e(t){H=t}class Ce{city;width;height;x;y;constructor(e,o,l,i,n){this.city=e,this.x=o,this.y=l,this.width=i,this.height=n}draw(e){if(this.city===null)return;e.fillStyle="#fff",e.fillRect(this.x,this.y,this.width,this.height),e.strokeStyle="black",e.strokeRect(this.x,this.y,this.width,this.height);const o=this.width*4/9,l=this.height*4/9,i=l/9,n=Object.entries(this.city).filter(([d,u])=>u>0).slice(0,3),c=this.y+i,a=c+l+i;n.forEach(([d,u],E)=>{let p=0,w=0;if(E===0)p=this.x+this.width/2-o/2,w=c;else if(E===1&&n.length===2)p=this.x+this.width/2-o/2,w=a;else{const b=E===1?i:i*2+o;p=this.x+b,w=a}e.fillStyle=se[d],e.fillRect(p,w,o,l),e.strokeStyle="black",e.strokeRect(p,w,o,l),e.fillStyle=d===r.BLUE?"white":"black",e.font=`${l-4}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(String(u),p+o/2,w+l/2+l*.05)})}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}class v{img;path;width;height;x;y;constructor(e,o,l,i,n,c){this.path=e,this.x=o,this.y=l,this.width=i,this.height=n,e&&(this.img=new Image,this.img.onload=c,this.img.src=e)}draw(e){if(!this.img||!this.img.complete)return;const o=Math.min(this.width/this.img.width,this.height/this.img.height),l=this.img.width*o,i=this.img.height*o,n=this.x+(this.width-l)/2,c=this.y+(this.height-i)/2;e.drawImage(this.img,n,c,l,i)}}class G{text;color;x;y;r;width;height;isRect;show;constructor(e,o,l,i,n,c,a,d,u=!0){this.text=e,this.color=o,this.x=l,this.y=i,this.r=n,this.width=c,this.height=a,this.isRect=d,this.show=u}draw(e){let o=0,l=0,i=0;e.fillStyle=this.show?this.color:oe,e.strokeStyle=this.show?"black":oe,this.isRect?(e.fillRect(this.x,this.y,this.width,this.height),e.strokeRect(this.x,this.y,this.width,this.height),o=this.height,l=this.width/2,i=this.height/2):(e.beginPath(),e.arc(this.x+this.r,this.y+this.r,this.r,0,Math.PI*2),e.fill(),e.stroke(),o=this.r*2,l=this.r,i=this.r),this.show&&(e.fillStyle=this.color===se[r.BLUE]?"white":"black",e.font=`${o-4}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(this.text,this.x+l,this.y+i+i*2*.05))}contains(e,o){const l=this.isRect?this.width:this.r*2,i=this.isRect?this.height:this.r*2;return e>=this.x&&e<=this.x+l&&o>=this.y&&o<=this.y+i}}class ye{text;width;height;x;y;constructor(e,o,l,i,n){this.text=e,this.x=o,this.y=l,this.width=i,this.height=n}draw(e){let o=this.height/2;e.fillStyle="black",e.font=`${o}px Arial`,e.textAlign="start",e.textBaseline="middle",e.fillText(this.text,this.x,this.y+o+o*2*.05)}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}const Ke="modulepreload",qe=function(t){return"/WebMarvel/"+t},ue={},Je=function(e,o,l){let i=Promise.resolve();if(o&&o.length>0){let d=function(u){return Promise.all(u.map(E=>Promise.resolve(E).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),a=c?.nonce||c?.getAttribute("nonce");i=d(o.map(u=>{if(u=qe(u),u in ue)return;ue[u]=!0;const E=u.endsWith(".css"),p=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const w=document.createElement("link");if(w.rel=E?"stylesheet":Ke,E||(w.as="script"),w.crossOrigin="",w.href=u,a&&w.setAttribute("nonce",a),document.head.appendChild(w),E)return new Promise((b,R)=>{w.addEventListener("load",b),w.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${u}`)))})}))}function n(c){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=c,window.dispatchEvent(a),!a.defaultPrevented)throw c}return i.then(c=>{for(const a of c||[])a.status==="rejected"&&n(a.reason);return e().catch(n)})};function Qe(t={}){const{immediate:e=!1,onNeedRefresh:o,onOfflineReady:l,onRegistered:i,onRegisteredSW:n,onRegisterError:c}=t;let a,d;const u=async(p=!0)=>{await d};async function E(){if("serviceWorker"in navigator){if(a=await Je(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/WebMarvel/sw.js",{scope:"/WebMarvel/",type:"classic"})).catch(p=>{c?.(p)}),!a)return;a.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),a.addEventListener("installed",p=>{p.isUpdate||l?.()}),a.register({immediate:e}).then(p=>{n?n("/WebMarvel/sw.js",p):i?.(p)}).catch(p=>{c?.(p)})}}return d=E(),u}Qe({immediate:!0});const le=[{id:"action_reset",icon:"ðŸ”„",title:"Reset",action:()=>{ne()}},{id:"action_add_player",icon:"ðŸ‘«",title:"Add Player",action:()=>{_e(k===2?3:k===3?4:2),ne()}},{id:"action_manual",icon:"ðŸ“–",title:"Manual",action:()=>{const t=["./assets/manual1.png","./assets/manual2.png","./assets/manual3.png","./assets/manual4.png"],e=window.open("","_blank");if(e){const o=e.document.head,l=e.document.createElement("title");l.textContent="Manual",o.appendChild(l);const i=e.document.createElement("link");i.rel="icon",i.href="./assets/favicon.png",i.type="image/png",o.appendChild(i);const n=e.document.createElement("style");n.textContent=`
                body {
                    margin: 0;
                    padding: 20px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    background: #f0f0f0;
                }
                img {
                    max-width: 80%;
                    margin-bottom: 20px;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                    border-radius: 8px;
                }
            `,o.appendChild(n);const c=e.document.body;t.forEach(a=>{const d=e.document.createElement("img");d.src=a,c.appendChild(d)})}}},{id:"action_show_people",icon:"âœ‹",title:"show people",action:()=>{lt()}}];function K(t){const e=[...t];for(let o=e.length-1;o>0;o--){const l=Math.floor(Math.random()*(o+1));[e[o],e[l]]=[e[l],e[o]]}return e}function Ze(){return ze(K(fe)),Fe(K(Ee)),Xe(K(pe)),[{backStack:ge,closeCard:new te(null,s.BLUE,0,0,0,0,0),openCards:[],color:s.BLUE,y:0},{backStack:me,closeCard:new te(null,s.ORANGE,0,0,0,0,0),openCards:[],color:s.ORANGE,y:0},{backStack:we,closeCard:new te(null,s.GREEN,0,0,0,0,0),openCards:[],color:s.GREEN,y:0}]}function Ve(){$e(K(Ye).slice(0,k))}function et(){const e=7-(k===2?3:k===3?2:0);He(new W({[h.YELLOW]:e,[h.BLUE]:e,[h.ORANGE]:e,[h.RED]:e,[h.PURPLE]:e,[h.GRAY]:5}))}function tt(){return je(Array.from({length:k},()=>new Ie)),Array.from({length:k},()=>({people:[],tokens:[],green:new G("G","#0f0",0,0,0,0,0,!1,!1),tmpTokens:[],scores:new ye("",0,0,0,0),cities:[],a:new v("",0,0,0,0,null),btnIn:new G("IN","#0f0",0,0,0,0,0,!0,!1),btnOut:new G("OUT","#0ff",0,0,0,0,0,!0,!1),showFirst:new v("",0,0,0,0,null),showWinner:new v("",0,0,0,0,null),coveredCards:[]}))}function ot(t,e){nt(t,e),st(t,e),it(t,e),ct(t,e),at(t,e),ut(t,e),ht(t,e),ft(t,e),de()}function N(){$(null),fe.forEach(t=>t.isSelected=!1),Ee.forEach(t=>t.isSelected=!1),pe.forEach(t=>t.isSelected=!1),C.forEach(t=>{t.coveredCards.forEach(e=>e.isSelected=!1)})}function rt(t){const e=g.cornerIndex,o=C[e].tmp.tokens;if(o[h.GRAY]!==0)return!1;if(t===h.GRAY)return Object.entries(o).filter(([d])=>d!==t.toString()).reduce((d,[,u])=>d+u,0)==0&&C[e].coveredCards.length<3;const l=Object.entries(o).filter(([c])=>c!==t.toString()&&t!==h.GRAY.toString());if(l.some(([,c])=>c===2))return!1;const n=l.reduce((c,[,a])=>c+a,0);return o[t]===0?n<=2:o[t]===1?n===0&&B.tokens[t]>=3:!1}function lt(){const t=window.open("show_people.html","hand");setTimeout(()=>{t?.postMessage({type:"HAND_UPDATE",players:C},"*")},300)}function nt(t,e){le.forEach(o=>{o.x<=t&&t<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&o.action()})}function st(t,e){D.forEach(o=>{if(o.contains(t,e)){const l=o.color;B.tokens[l]>0&&(rt(l)?(B.tokens[l]--,o.value=B.tokens[l],C[g.cornerIndex].tmp.tokens[l]++):(V(),N()))}})}function it(t,e){_.forEach(o=>{const l=o.closeCard,i=l.contains(t,e);i&&l.card!==null&&(N(),l.card.isSelected=i,$(l.card)),o.openCards.forEach(n=>{n.contains(t,e)&&n.card!==null&&(N(),n.card.isSelected=!0,$(n.card))})}),j.forEach((o,l)=>{l===g.cornerIndex&&o.coveredCards.forEach(i=>{i.contains(t,e)&&i.card!==null&&(N(),i.card.isSelected=!0,$(i.card))})})}function z(){const t=Le();g.pointTo(t,!0)}function Oe(){let t=!0;C.forEach(e=>{e.isClean()||(t=!1)}),t&&De(g.cornerIndex)}function ct(t,e){j.forEach((o,l)=>{o.btnIn.contains(t,e)?be(l):o.btnOut.contains(t,e)&&Se(l)})}function at(t,e){Q.forEach((o,l)=>{if(o.contains(t,e))for(let i=0;i<=k;i++)ke(i,l,!0)})}function dt(t){const e=C[g.cornerIndex];e.tokens.tokens[t]--,e.tmp.tokens[t]++}function ut(t,e){j.forEach(o=>{o.tokens.forEach(l=>{l.contains(t,e)&&dt(l.color)})})}function ht(t,e){g.contains(t,e)&&(z(),Oe())}function ft(t,e){let o=L;o.x<=t&&t<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&be(g.cornerIndex),o=I,o.x<=t&&t<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&Se(g.cornerIndex)}function ce(){const t=C[g.cornerIndex],e=t.tmp.tokens,o=t.tokens.tokens;for(const l of Object.values(h))o[l]+=e[l];t.tmp=new W}function V(){const t=C[g.cornerIndex],e=t.tmp.tokens,o=B.tokens;for(const l of Object.values(h))o[l]+=e[l];t.tmp=new W}function pt(){confirm("é€€éŒ¯è«‹æŒ‰ã€Œç¢ºå®šã€æ”¶å›žï¼›ä¸èƒ½ç›´æŽ¥æ‹¿ï¼è«‹æŒ‰ã€Œå–æ¶ˆã€é‚„éŠ€è¡Œ")?ce():(V(),N())}function Et(){confirm("ç¢ºå®šä¸æ‹¿ç°è‰²ï¼Ÿ")&&C[g.cornerIndex].coveredCards.length<3&&ae()}function gt(){confirm("ä¸èƒ½è²·ï¼Œæ˜¯å¦æ”¶å…¥è“‹ç‰Œä¸­ï¼Ÿ")&&C[g.cornerIndex].coveredCards.length<3&&ae()}function Ae(){_.forEach(t=>{let e=t.closeCard.card;e!==null&&e==S&&(e=t.backStack.shift()??null),t.openCards.forEach(o=>{if(o.card!==null&&o.card==S){const l=t.backStack.shift()??null;o.card=l}})})}function ae(){const t=g.cornerIndex,e=C[t];S!==null&&e.coveredCards.push(S),ce(),Ae(),N();const o=e.showGreen()?1:0;Object.entries(e.tokens.tokens).reduce((i,[,n])=>i+n,0)+o<=10&&(J(t),z())}function mt(t,e,o,l,i){if(S===null)return;const n=t+e+o+l+i,c=S,a=C[g.cornerIndex],d=a.tokens.tokens,u=Math.max(c.price[r.YELLOW]-a.getYellowCardsCount(),0),E=Math.max(c.price[r.BLUE]-a.getBlueCardsCount(),0),p=Math.max(c.price[r.ORANGE]-a.getOrangeCardsCount(),0),w=Math.max(c.price[r.RED]-a.getRedCardsCount(),0),b=Math.max(c.price[r.PURPLE]-a.getPurpleCardsCount(),0);d[h.YELLOW]-=u,d[h.YELLOW]=Math.max(d[h.YELLOW],0),d[h.BLUE]-=E,d[h.BLUE]=Math.max(d[h.BLUE],0),d[h.ORANGE]-=p,d[h.ORANGE]=Math.max(d[h.ORANGE],0),d[h.RED]-=w,d[h.RED]=Math.max(d[h.RED],0),d[h.PURPLE]-=b,d[h.PURPLE]=Math.max(d[h.PURPLE],0),d[h.GRAY]-=n;const R=B.tokens;R[h.YELLOW]+=u-t,R[h.BLUE]+=E-e,R[h.ORANGE]+=p-o,R[h.RED]+=w-l,R[h.PURPLE]+=b-i,R[h.GRAY]+=n}function Re(){const t=C.find(l=>l.hasA),e=C.filter(l=>l.getNumOfA()>=3).sort((l,i)=>i.getNumOfA()-l.getNumOfA());if(e.length===0)return;const o=e[0];if(!t){o.hasA=!0;return}o.getNumOfA()>t.getNumOfA()&&(t.hasA=!1,o.hasA=!0)}function wt(){const t=g.cornerIndex,e=C[t],o=[];H.forEach((i,n)=>{i!==null&&i[r.YELLOW]<=e.getYellowCardsCount()&&i[r.BLUE]<=e.getBlueCardsCount()&&i[r.ORANGE]<=e.getOrangeCardsCount()&&i[r.RED]<=e.getRedCardsCount()&&i[r.PURPLE]<=e.getPurpleCardsCount()&&o.push(n)});const l=o.length;return l===0?(Re(),!0):l===1?(ke(t,o[0]),!0):(alert("è«‹é¸ä¸€å¼µåŸŽå¸‚å¡"),!1)}function ke(t,e,o=!1){if(g.cornerIndex!==t)return;const i=C[t];let n=H[e];n!==null&&n[r.YELLOW]<=i.getYellowCardsCount()&&n[r.BLUE]<=i.getBlueCardsCount()&&n[r.ORANGE]<=i.getOrangeCardsCount()&&n[r.RED]<=i.getRedCardsCount()&&n[r.PURPLE]<=i.getPurpleCardsCount()&&(i.city.push(n),H[e]=null),Re(),o&&(J(t),z())}function be(t){if(g.cornerIndex!==t)return;const e=C[t],o=e.tokens.tokens,l=e.tmp.tokens;if(l[h.GRAY]!==0)if(S===null||e.coveredCards.some(c=>c.name===S?.name)){pt();return}else{ae();return}const n=Object.entries(l).filter(([c])=>c!==h.GRAY.toString()).reduce((c,[,a])=>c+a,0);if(S==null)if(n>0){ce();const c=e.showGreen()?1:0;Object.entries(o).reduce((d,[,u])=>d+u,0)+c<=10&&(J(t),z())}else return;else if(n>0)V(),N();else{if(e.coveredCards.length<3&&_.some(O=>O.closeCard.card==S)){Et();return}const c=S,a=e.getYellowCardsCount()+o[h.YELLOW],d=e.getBlueCardsCount()+o[h.BLUE],u=e.getOrangeCardsCount()+o[h.ORANGE],E=e.getRedCardsCount()+o[h.RED],p=e.getPurpleCardsCount()+o[h.PURPLE],w=c.price[r.YELLOW]>a?c.price[r.YELLOW]-a:0,b=c.price[r.BLUE]>d?c.price[r.BLUE]-d:0,R=c.price[r.ORANGE]>u?c.price[r.ORANGE]-u:0,F=c.price[r.RED]>E?c.price[r.RED]-E:0,X=c.price[r.PURPLE]>p?c.price[r.PURPLE]-p:0,Y=w+b+R+F+X;if(o[h.GRAY]>=Y){if(mt(w,b,R,F,X),e.addCard(c),e.coveredCards.some(A=>A.name===c.name)){const A=e.coveredCards.findIndex(P=>P.name===c.name);A!==-1&&e.coveredCards.splice(A,1)}else Ae();wt()&&(J(t),z())}else{gt();return}N()}}function Se(t){g.cornerIndex===t&&(V(),N())}function J(t){if(t!==(k-1+ie)%k)return;if(Array.from({length:k},(c,a)=>C[a].canWin())[t]){C[t].isWinner=!0;return}const o=C.filter(c=>c.canWin());if(o.length===0)return;const l=o.sort((c,a)=>a.getScores()-c.getScores()),i=l.filter(c=>c.getScores()===l[0].getScores());if(i.length===1){i[0].isWinner=!0;return}const n=i.find(c=>c.hasA);if(n)n.isWinner=!0;else{const c=i.sort((d,u)=>d.people.length-u.people.length);c.filter(d=>d.people.length===c[0].people.length).forEach(d=>d.isWinner=!0)}}let _=[],Q=[],D=[],j=[];const g=new Me(200,200,48),L=new G("IN","#0f0",0,0,0,400,200,!0,!0),I=new G("OUT","#0ff",0,0,0,400,200,!0,!0);let U=new v("",0,0,0,0,T),x=new v("",0,0,0,0,T);const y=document.getElementById("canvas"),m=y.getContext("2d"),f=10,Ct=1/30,yt=1/20,Ot=1/30,At=1/50,Rt=1/40,kt=1/40;let Z=0,ee=0,ve=0;function bt(){const t=y.width*Ct,e=ee+f,o=Z-f-t;U.x=e,U.y=o,U.width=t,U.height=t,x.x=e+f+t,x.y=o,x.width=t,x.height=t}function St(){const t=y.width*yt,e=t*2,o=t+f,l=y.width/2-t*1.5-f*1;ee=l+t*4+f*3;const i=(y.height-M)/2-e*1-f;Z=i,_.forEach((n,c)=>{if(n.y=i+c*(e+f),n.openCards.length===0)for(let d=0;d<4;d++){const u=n.backStack.shift()??null;n.openCards.push(new he(u,n.color,l+d*o,n.y,t,e))}else n.openCards.forEach((d,u)=>{d.x=l+u*o,d.y=n.y,d.width=t,d.height=e});const a=n.backStack.length;n.closeCard.card=a>0?n.backStack[0]:null,n.closeCard.cardLeft=a,n.closeCard.x=l-o,n.closeCard.y=n.y,n.closeCard.width=t,n.closeCard.height=e})}function vt(){const t=y.width*Ot,e=t,o=t+f,l=ee+f;ve=Z+2*e+f,Q=[],H.forEach((i,n)=>{const c=n%2,a=n<2?0:1;Q.push(new Ce(i,l+c*o,Z+a*(e+f),t,e))})}function Lt(){const t=y.width*Rt/2,e=t*2+f,o=ee+f,l=ve+f;D=[],Object.values(h).forEach((i,n)=>{const c=n%2,a=Math.floor(n/2);D.push(new re(B.tokens[i],i,o+c*e,l+a*e,t))})}function Gt(){const t=y.width*At,e=t*6+f*4,o=.8,l=f+(t+f)*8+(t*o+f)*3,i=4;j.forEach((n,c)=>{const a=C[c],d=c<2?f:y.width-f-l;let u=d+t,E=c===0||c===3?y.height-f-t:M+f+e;const p=E-e;let w=a.isWinner?"./assets/thanos.webp":"";const b=Math.min(l,e);n.showWinner=new v(w,d,p,b,b,q),n.btnIn=new G("IN","#0f0",u,E,0,t*2,t,!0,!0),u+=t*2+f*2,n.btnOut=new G("OUT","#0ff",u,E,0,t*2,t,!0,!0),u+=t*2+f*2,w=ie===c?"./assets/first.png":"",n.showFirst=new v(w,u,E,t*2,t,q),E-=t+f,u=d,n.scores=new ye(`åˆ†ï¼š${a.getScores()} Aï¼š${a.getNumOfA()}`,u,E,t*4,t),u+=n.scores.width+f,a.city.forEach((O,A)=>{const P=new Ce(O,u+A*(t+f),E,t,t);n.cities.push(P)});const R=a.city.length;let F=Array.from({length:i-R},(O,A)=>new G("",oe,u+(R+A)*(t+f),E,0,t,t,!0,!1));n.cities.push(...F),u+=i*(t+f),w=a.hasA?"./assets/marvel_a.png":"",n.a=new v(w,u,E,t,t,q),E-=t+f,u=d,n.tokens=[],Object.values(h).forEach(O=>{n.tokens.push(new re(a.tokens.tokens[O],O,u,E,t/2)),u+=t+f});const X=a.showGreen();n.green=new G("G","#0F0",u,E,t/2,0,0,!1,X),u+=(t+f)*2,n.tmpTokens=[],Object.values(h).forEach(O=>{const A=a.tmp.tokens[O],P=n.tmpTokens.length;A>0&&n.tmpTokens.push(new re(A,O,u+P*(t*.8+f),E,t*o/2))}),u=d,E-=t+f,n.people=[],Object.values(r).forEach((O,A)=>{const P=a.getCardsCount(O);n.people.push(new G(String(P),se[O],u+A*(t+f),E,0,t,t,!0,P>0))});const Y=t*1.5;E-=Y*2+f,n.coveredCards=[],a.coveredCards.forEach((O,A)=>{n.coveredCards.push(new he(O,O.color,u+A*(Y+f),E,Y,Y*2))})})}function Nt(){const t=D[D.length-1];g.size=y.width*kt,g.x=t.x,g.y=t.y+t.r*2+f+g.size}function Pt(){L.x=g.x-g.size,L.y=g.y+g.size+f,L.width=g.size*2,L.height=g.size,I.x=L.x,I.y=L.y+L.height+f,I.width=L.width,I.height=L.height}const M=30;function Bt(){const t=y.width/le.length;le.forEach((e,o)=>{const l=o*t,i=0;e.x=l,e.y=i,e.width=t,e.height=M,m.fillStyle="#fff",m.fillRect(l+2,i,t-4,M),m.font="20px Arial",m.textAlign="center",m.textBaseline="middle",m.fillStyle="#000",m.fillText(e.icon,l+t/2-30,M/2),m.font="16px Arial",m.fillText(e.title,l+t/2+30,M/2)})}function T(){C.some(o=>o.hasA)&&(U=new v("",0,0,0,0,T)),U.draw(m),C.some(o=>o.isWinner)&&(x=new v("",0,0,0,0,T)),x.draw(m)}function Ut(){_.forEach(t=>{t.closeCard.draw(m),t.openCards.forEach(e=>e.draw(m))})}function xt(){Q.forEach(t=>t.draw(m))}function Wt(){D.forEach(t=>t.draw(m))}function q(){j.forEach(t=>{t.people.forEach(e=>e.draw(m)),t.tokens.forEach(e=>e.draw(m)),t.green.draw(m),t.tmpTokens.forEach(e=>e.draw(m)),t.scores.draw(m),t.cities.forEach(e=>e.draw(m)),t.a.draw(m),t.btnIn.draw(m),t.btnOut.draw(m),t.showFirst.draw(m),t.coveredCards.forEach(e=>e.draw(m)),t.showWinner.draw(m)})}function Le(){return[{x:0,y:y.height},{x:0,y:0},{x:y.width,y:0},{x:y.width,y:y.height}].slice(0,k)}function Tt(){const t=Le();g.pointTo(t,!1),g.draw(m)}function Yt(){L.draw(m),I.draw(m)}function de(){m.clearRect(0,0,y.width,y.height),Bt(),St(),Ut(),bt(),T(),vt(),xt(),Lt(),Wt(),Gt(),q(),Nt(),Tt(),Pt(),Yt()}function ne(){U=new v("./assets/marvel_a.png",0,0,0,0,T),x=new v("./assets/thanos.webp",0,0,0,0,T),y.width=window.innerWidth,y.height=window.innerHeight,_=Ze(),Ve(),et(),j=tt(),g.resetCornerIndex(),Oe(),de()}function It(){y.width=window.innerWidth,y.height=window.innerHeight,de()}y.addEventListener("click",t=>{const e=y.getBoundingClientRect(),o=t.clientX-e.left,l=t.clientY-e.top;ot(o,l)});window.addEventListener("resize",It);ne();
