import{L as s,C as r,T as P,c as ne,t as q,a as h,b as se,d as J}from"./card_open-DIcfzGlm.js";const ie=[{name:"Hulk",numOfA:2,price:{yellow:0,blue:3,orange:5,red:3,purple:3},score:3,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Spider Man",numOfA:0,price:{yellow:7,blue:0,orange:0,red:3,purple:0},score:5,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Green Goblin",numOfA:0,price:{yellow:0,blue:7,orange:0,red:0,purple:3},score:5,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Doctor Octopus",numOfA:0,price:{yellow:0,blue:7,orange:0,red:0,purple:0},score:4,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Vision",numOfA:1,price:{yellow:3,blue:6,orange:0,red:3,purple:0},score:4,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Doctor Strange",numOfA:1,price:{yellow:0,blue:0,orange:0,red:0,purple:7},score:4,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Captain Marvel",numOfA:1,price:{yellow:0,blue:3,orange:6,red:0,purple:3},score:4,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Iron Fist",numOfA:0,price:{yellow:0,blue:0,orange:0,red:7,purple:0},score:4,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Thor",numOfA:2,price:{yellow:3,blue:3,orange:0,red:3,purple:5},score:3,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Loki",numOfA:0,price:{yellow:0,blue:3,orange:0,red:0,purple:7},score:5,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Gamora",numOfA:0,price:{yellow:0,blue:0,orange:3,red:7,purple:0},score:5,color:r.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Ant Man",numOfA:1,price:{yellow:3,blue:0,orange:3,red:6,purple:0},score:4,color:r.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Drax",numOfA:0,price:{yellow:0,blue:0,orange:7,red:0,purple:0},score:4,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Luke Cage",numOfA:0,price:{yellow:3,blue:0,orange:7,red:0,purple:0},score:5,color:r.PURPLE,levelColor:s.BLUE,isSelected:!1},{name:"Captain America",numOfA:2,price:{yellow:5,blue:3,orange:3,red:0,purple:3},score:3,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Black Widow",numOfA:2,price:{yellow:3,blue:3,orange:0,red:5,purple:3},score:3,color:r.BLUE,levelColor:s.BLUE,isSelected:!1},{name:"Nova",numOfA:0,price:{yellow:0,blue:0,orange:3,red:3,purple:6},score:4,color:r.RED,levelColor:s.BLUE,isSelected:!1},{name:"Black Bolt",numOfA:0,price:{yellow:7,blue:0,orange:0,red:0,purple:0},score:4,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1},{name:"Iron Man",numOfA:2,price:{yellow:3,blue:5,orange:3,red:3,purple:0},score:3,color:r.YELLOW,levelColor:s.BLUE,isSelected:!1},{name:"Black Panther",numOfA:1,price:{yellow:6,blue:0,orange:3,red:0,purple:3},score:4,color:r.ORANGE,levelColor:s.BLUE,isSelected:!1}];class K{card;color;cardLeft;x;y;width;height;constructor(e,o,t,i,n,c,u){this.card=e,this.color=o,this.cardLeft=t,this.x=i,this.y=n,this.width=c,this.height=u}draw(e){this.card!==null&&(e.fillStyle=this.color,e.fillRect(this.x,this.y,this.width,this.height),e.lineWidth=this.card.isSelected?5:1,e.strokeStyle=this.card.isSelected?"red":"black",e.strokeRect(this.x,this.y,this.width,this.height),e.fillStyle="white",e.font="20px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(`${this.cardLeft}`,this.x+this.width/2,this.y+this.height/2)),e.lineWidth=1}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}const ce=[{name:"Prowler",numOfA:0,price:{yellow:0,blue:1,orange:1,red:2,purple:1},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Wong",numOfA:0,price:{yellow:1,blue:1,orange:2,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Modok",numOfA:0,price:{yellow:0,blue:0,orange:2,red:2,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Rocket",numOfA:0,price:{yellow:1,blue:0,orange:0,red:2,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Abomination",numOfA:0,price:{yellow:0,blue:2,orange:1,red:1,purple:1},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Gorgon",numOfA:0,price:{yellow:2,blue:2,orange:0,red:0,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Kraven",numOfA:0,price:{yellow:0,blue:3,orange:0,red:0,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Spider Woman",numOfA:1,price:{yellow:1,blue:1,orange:0,red:3,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Spider Man 2099",numOfA:0,price:{yellow:2,blue:0,orange:0,red:1,purple:0},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Sand Man",numOfA:0,price:{yellow:0,blue:0,orange:4,red:0,purple:0},score:1,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Crystal",numOfA:0,price:{yellow:0,blue:0,orange:2,red:0,purple:2},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Winter Soldier",numOfA:1,price:{yellow:0,blue:2,orange:1,red:2,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Rhino",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Squirrel Girl",numOfA:1,price:{yellow:0,blue:0,orange:1,red:2,purple:2},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Task Master",numOfA:0,price:{yellow:4,blue:0,orange:0,red:0,purple:0},score:1,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Elektra",numOfA:0,price:{yellow:2,blue:0,orange:0,red:0,purple:2},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Vulture",numOfA:0,price:{yellow:0,blue:0,orange:0,red:4,purple:0},score:1,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Scarlet Spider",numOfA:0,price:{yellow:0,blue:1,orange:1,red:1,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Spider Girl",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Lockjaw",numOfA:0,price:{yellow:1,blue:1,orange:1,red:0,purple:1},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Lizard",numOfA:0,price:{yellow:0,blue:2,orange:0,red:0,purple:1},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Hawkeye",numOfA:1,price:{yellow:1,blue:2,orange:0,red:0,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Mysterio",numOfA:0,price:{yellow:0,blue:0,orange:3,red:0,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Valkyrie",numOfA:1,price:{yellow:3,blue:0,orange:1,red:0,purple:1},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Kingpin",numOfA:0,price:{yellow:1,blue:0,orange:0,red:0,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Yondu",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:4},score:1,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Electro",numOfA:0,price:{yellow:0,blue:0,orange:2,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Bullseye",numOfA:0,price:{yellow:0,blue:1,orange:1,red:2,purple:1},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Grand Master",numOfA:0,price:{yellow:1,blue:1,orange:0,red:1,purple:1},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1},{name:"Spider Ham",numOfA:0,price:{yellow:1,blue:0,orange:0,red:0,purple:2},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Silver Sable",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:3},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Wasp",numOfA:1,price:{yellow:2,blue:1,orange:2,red:0,purple:0},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Quake",numOfA:1,price:{yellow:0,blue:1,orange:3,red:0,purple:1},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Triton",numOfA:0,price:{yellow:1,blue:1,orange:1,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"America Chavez",numOfA:1,price:{yellow:1,blue:3,orange:0,red:1,purple:0},score:0,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Kate Bishop",numOfA:1,price:{yellow:0,blue:1,orange:0,red:1,purple:3},score:0,color:r.ORANGE,levelColor:s.GREEN,isSelected:!1},{name:"Moon Knight",numOfA:0,price:{yellow:3,blue:0,orange:0,red:0,purple:0},score:0,color:r.BLUE,levelColor:s.GREEN,isSelected:!1},{name:"Scorpion",numOfA:0,price:{yellow:0,blue:4,orange:0,red:0,purple:0},score:1,color:r.PURPLE,levelColor:s.GREEN,isSelected:!1},{name:"Ms. Marvel",numOfA:1,price:{yellow:2,blue:0,orange:2,red:1,purple:0},score:0,color:r.RED,levelColor:s.GREEN,isSelected:!1},{name:"Baron Zemo",numOfA:0,price:{yellow:0,blue:0,orange:0,red:3,purple:0},score:0,color:r.YELLOW,levelColor:s.GREEN,isSelected:!1}],ae=[{name:"Hela",numOfA:0,price:{yellow:0,blue:6,orange:0,red:0,purple:0},score:3,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Cross Bones",numOfA:0,price:{yellow:4,blue:2,orange:1,red:0,purple:0},score:2,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Beta Ray Bill",numOfA:1,price:{yellow:0,blue:3,orange:2,red:3,purple:0},score:1,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Maximus",numOfA:0,price:{yellow:0,blue:2,orange:4,red:1,purple:0},score:2,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Quick Silver",numOfA:1,price:{yellow:2,blue:0,orange:0,red:3,purple:3},score:1,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Red Skull",numOfA:0,price:{yellow:0,blue:0,orange:6,red:0,purple:0},score:3,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Star Lord",numOfA:0,price:{yellow:0,blue:1,orange:2,red:4,purple:0},score:2,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"She Hulk",numOfA:1,price:{yellow:3,blue:0,orange:2,red:0,purple:2},score:1,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Okoye",numOfA:1,price:{yellow:3,blue:2,orange:0,red:0,purple:3},score:1,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Karnak",numOfA:0,price:{yellow:3,blue:0,orange:5,red:0,purple:0},score:2,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"The Collector",numOfA:0,price:{yellow:0,blue:0,orange:5,red:0,purple:0},score:2,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Medusa",numOfA:0,price:{yellow:0,blue:5,orange:3,red:0,purple:0},score:2,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Dare Devil",numOfA:0,price:{yellow:0,blue:0,orange:0,red:6,purple:0},score:3,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Miles Morales",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:5},score:2,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Black Cat",numOfA:0,price:{yellow:0,blue:0,orange:0,red:3,purple:5},score:2,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Scarlet Witch",numOfA:1,price:{yellow:2,blue:3,orange:0,red:2,purple:0},score:1,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Shuri",numOfA:1,price:{yellow:3,blue:2,orange:3,red:0,purple:0},score:1,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1},{name:"Nick Fury",numOfA:1,price:{yellow:0,blue:0,orange:3,red:3,purple:2},score:1,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Venom",numOfA:0,price:{yellow:0,blue:5,orange:0,red:0,purple:0},score:2,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"Jessica Jones",numOfA:0,price:{yellow:6,blue:0,orange:0,red:0,purple:0},score:3,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Nebula",numOfA:0,price:{yellow:0,blue:0,orange:0,red:0,purple:6},score:3,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Ghost Spider",numOfA:0,price:{yellow:0,blue:2,orange:1,red:0,purple:4},score:2,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Carnage",numOfA:0,price:{yellow:5,blue:0,orange:0,red:3,purple:0},score:2,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Ghost Rider",numOfA:0,price:{yellow:2,blue:4,orange:0,red:0,purple:1},score:2,color:r.RED,levelColor:s.ORANGE,isSelected:!1},{name:"War Machine",numOfA:1,price:{yellow:0,blue:2,orange:2,red:0,purple:3},score:1,color:r.BLUE,levelColor:s.ORANGE,isSelected:!1},{name:"Ronan",numOfA:0,price:{yellow:5,blue:0,orange:0,red:0,purple:0},score:2,color:r.PURPLE,levelColor:s.ORANGE,isSelected:!1},{name:"Punisher",numOfA:0,price:{yellow:0,blue:0,orange:0,red:5,purple:0},score:2,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Falcon",numOfA:1,price:{yellow:3,blue:0,orange:0,red:3,purple:2},score:1,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Groot",numOfA:0,price:{yellow:0,blue:0,orange:0,red:5,purple:3},score:2,color:r.ORANGE,levelColor:s.ORANGE,isSelected:!1},{name:"Maria Hill",numOfA:1,price:{yellow:0,blue:2,orange:3,red:0,purple:2},score:1,color:r.YELLOW,levelColor:s.ORANGE,isSelected:!1}];function Oe(){return{yellow:4,blue:4,orange:0,red:0,purple:0}}function Ae(){return{yellow:0,blue:0,orange:0,red:4,purple:4}}function Re(){return{yellow:4,blue:0,orange:4,red:0,purple:0}}function ke(){return{yellow:0,blue:0,orange:4,red:0,purple:4}}function Se(){return{yellow:0,blue:4,orange:0,red:4,purple:0}}function be(){return{yellow:3,blue:0,orange:3,red:0,purple:3}}function Le(){return{yellow:0,blue:3,orange:0,red:3,purple:3}}function ve(){return{yellow:3,blue:3,orange:0,red:3,purple:0}}const Ge=[Oe(),Ae(),Re(),ke(),Se(),be(),Le(),ve()];class Ne{tokens;city;people;tmp;coveredCards;hasA;isWinner;constructor(){this.tokens=new P,this.city=[],this.people=[],this.tmp=new P,this.coveredCards=[],this.hasA=!1,this.isWinner=!1}addCard(e){this.people.push(e)}getCardsCount(e){return this.people.filter(o=>o.color===e).length}getYellowCardsCount(){return this.people.filter(e=>e.color===r.YELLOW).length}getBlueCardsCount(){return this.people.filter(e=>e.color===r.BLUE).length}getOrangeCardsCount(){return this.people.filter(e=>e.color===r.ORANGE).length}getRedCardsCount(){return this.people.filter(e=>e.color===r.RED).length}getPurpleCardsCount(){return this.people.filter(e=>e.color===r.PURPLE).length}showCity1(){return this.city.length>=1}showCity2(){return this.city.length>=2}showCity3(){return this.city.length>=3}showCity4(){return this.city.length>=4}showGreen(){return this.people.some(e=>e.levelColor===s.BLUE)}getScores(){const e=this.people.reduce((i,n)=>i+n.score,0),o=this.city.length*3,t=this.hasA?3:0;return e+o+t}getNumOfA(){return this.people.reduce((e,o)=>e+o.numOfA,0)}canWin(){return this.people.some(e=>e.color===r.YELLOW)&&this.people.some(e=>e.color===r.BLUE)&&this.people.some(e=>e.color===r.ORANGE)&&this.people.some(e=>e.color===r.RED)&&this.people.some(e=>e.color===r.PURPLE)&&this.showGreen()&&this.getScores()>=16}isClean(){return this.tokens.equals(new P)&&this.city.length===0&&this.people.length===0&&this.coveredCards.length===0}}class Pe{x;y;size;angle=0;targetAngle=0;cornerIndex=0;bounce=0;constructor(e,o,t=48){this.x=e,this.y=o,this.size=t}resetCornerIndex(){this.cornerIndex=0}pointTo(e,o){const t=e.length;o&&(this.cornerIndex=(this.cornerIndex+1)%t);const i=e[this.cornerIndex].x,n=e[this.cornerIndex].y;this.targetAngle=Math.atan2(n-this.y,i-this.x),this.bounce=1}draw(e){const o=this.x,t=this.y;this.angle=this.targetAngle,e.save(),e.translate(o,t),e.rotate(this.angle),e.font=`${this.size}px serif`,e.textAlign="center",e.textBaseline="middle",e.fillText("ğŸ‘‰",0,0),e.restore()}contains(e,o){const t=e-this.x,i=o-this.y,n=Math.cos(-this.angle),c=Math.sin(-this.angle),u=t*n-i*c,a=t*c+i*n,d=this.size*.5;return u>=-d&&u<=d&&a>=-d&&a<=d}}let ee=0;function Be(l){ee=l}let R=2;function Ue(l){R=l}let C=[];function xe(l){C=l}let N=new P;function We(l){N=l}let S=null;function j(l){S=l}let ue=[];function Te(l){ue=l}let de=[];function Ye(l){de=l}let he=[];function Ie(l){he=l}let I=[];function Me(l){I=l}class fe{city;width;height;x;y;constructor(e,o,t,i,n){this.city=e,this.x=o,this.y=t,this.width=i,this.height=n}draw(e){if(this.city===null)return;e.fillStyle="#fff",e.fillRect(this.x,this.y,this.width,this.height),e.strokeStyle="black",e.strokeRect(this.x,this.y,this.width,this.height);const o=this.width/3,t=this.height/3,i=t/3,n=Object.entries(this.city).filter(([a,d])=>d>0).slice(0,3),c=this.y+i,u=c+t+i;n.forEach(([a,d],p)=>{let A=0,w=0;if(p===0)A=this.x+this.width/2-o/2,w=c;else if(p===1&&n.length===2)A=this.x+this.width/2-o/2,w=u;else{const b=p===1?i:i*2+o;A=this.x+b,w=u}e.fillStyle=ne[a],e.fillRect(A,w,o,t),e.strokeStyle="black",e.strokeRect(A,w,o,t),e.fillStyle="black",e.font=`${t-4}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(String(d),A+o/2,w+t/2+t*.05)})}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}class x{img;path;width;height;x;y;constructor(e,o,t,i,n,c){this.path=e,this.x=o,this.y=t,this.width=i,this.height=n,e&&(this.img=new Image,this.img.onload=c,this.img.src=e)}draw(e){if(!this.img||!this.img.complete)return;const o=Math.min(this.width/this.img.width,this.height/this.img.height),t=this.img.width*o,i=this.img.height*o,n=this.x+(this.width-t)/2,c=this.y+(this.height-i)/2;e.drawImage(this.img,n,c,t,i)}}class G{text;color;x;y;r;width;height;isRect;show;constructor(e,o,t,i,n,c,u,a,d=!0){this.text=e,this.color=o,this.x=t,this.y=i,this.r=n,this.width=c,this.height=u,this.isRect=a,this.show=d}draw(e){let o=0,t=0,i=0;e.fillStyle=this.show?this.color:q,e.strokeStyle=this.show?"black":q,this.isRect?(e.fillRect(this.x,this.y,this.width,this.height),e.strokeRect(this.x,this.y,this.width,this.height),o=this.height,t=this.width/2,i=this.height/2):(e.beginPath(),e.arc(this.x+this.r,this.y+this.r,this.r,0,Math.PI*2),e.fill(),e.stroke(),o=this.r*2,t=this.r,i=this.r),this.show&&(e.fillStyle="black",e.font=`${o-4}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(this.text,this.x+t,this.y+i+i*2*.05))}contains(e,o){const t=this.isRect?this.width:this.r*2,i=this.isRect?this.height:this.r*2;return e>=this.x&&e<=this.x+t&&o>=this.y&&o<=this.y+i}}class pe{text;width;height;x;y;constructor(e,o,t,i,n){this.text=e,this.x=o,this.y=t,this.width=i,this.height=n}draw(e){let o=this.height/2;e.fillStyle="black",e.font=`${o}px Arial`,e.textAlign="start",e.textBaseline="middle",e.fillText(this.text,this.x,this.y+o+o*2*.05)}contains(e,o){return e>=this.x&&e<=this.x+this.width&&o>=this.y&&o<=this.y+this.height}}const Q=[{id:"action_reset",icon:"ğŸ”„",title:"Reset",action:()=>{V()}},{id:"action_add_player",icon:"ğŸ‘«",title:"Add Player",action:()=>{Ue(R===2?3:R===3?4:2),V()}},{id:"action_manual",icon:"ğŸ“–",title:"Manual",action:()=>{const l=["./res/manual1.png","./res/manual2.png","./res/manual3.png","./res/manual4.png"],e=window.open("","_blank");if(e){const o=e.document.head,t=e.document.createElement("title");t.textContent="Manual",o.appendChild(t);const i=e.document.createElement("link");i.rel="icon",i.href="./res/favicon.png",i.type="image/png",o.appendChild(i);const n=e.document.createElement("style");n.textContent=`
                body {
                    margin: 0;
                    padding: 20px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    background: #f0f0f0;
                }
                img {
                    max-width: 80%;
                    margin-bottom: 20px;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                    border-radius: 8px;
                }
            `,o.appendChild(n);const c=e.document.body;l.forEach(u=>{const a=e.document.createElement("img");a.src=u,c.appendChild(a)})}}},{id:"action_show_people",icon:"âœ‹",title:"show people",action:()=>{Xe()}}];function F(l){const e=[...l];for(let o=e.length-1;o>0;o--){const t=Math.floor(Math.random()*(o+1));[e[o],e[t]]=[e[t],e[o]]}return e}function De(){return Te(F(ie)),Ye(F(ae)),Ie(F(ce)),[{backStack:ue,closeCard:new K(null,s.BLUE,0,0,0,0,0),openCards:[],color:s.BLUE,y:0},{backStack:de,closeCard:new K(null,s.ORANGE,0,0,0,0,0),openCards:[],color:s.ORANGE,y:0},{backStack:he,closeCard:new K(null,s.GREEN,0,0,0,0,0),openCards:[],color:s.GREEN,y:0}]}function He(){Me(F(Ge).slice(0,R))}function je(){const e=7-(R===2?3:R===3?2:0);We(new P({[h.YELLOW]:e,[h.BLUE]:e,[h.ORANGE]:e,[h.RED]:e,[h.PURPLE]:e,[h.GRAY]:5}))}function Fe(){return xe(Array.from({length:R},()=>new Ne)),Array.from({length:R},()=>({people:[],tokens:[],green:new G("G","#0f0",0,0,0,0,0,!1,!1),tmpTokens:[],scores:new pe("",0,0,0,0),cities:[],a:new x("",0,0,0,0,null),btnIn:new G("IN","#f0f",0,0,0,0,0,!0,!1),btnOut:new G("OUT","#f0f",0,0,0,0,0,!0,!1),showFirst:new x("",0,0,0,0,null),showWinner:new x("",0,0,0,0,null),coveredCards:[]}))}function _e(l,e){$e(l,e),Ke(l,e),qe(l,e),Je(l,e),Qe(l,e),Ve(l,e),el(l,e),te()}function L(){j(null),ie.forEach(l=>l.isSelected=!1),ae.forEach(l=>l.isSelected=!1),ce.forEach(l=>l.isSelected=!1),C.forEach(l=>{l.coveredCards.forEach(e=>e.isSelected=!1)})}function ze(l){const e=g.cornerIndex,o=C[e].tmp.tokens;if(o[h.GRAY]!==0)return!1;if(l===h.GRAY)return Object.entries(o).filter(([a])=>a!==l.toString()).reduce((a,[,d])=>a+d,0)==0&&C[e].coveredCards.length<3;const t=Object.entries(o).filter(([c])=>c!==l.toString()&&l!==h.GRAY.toString());if(t.some(([,c])=>c===2))return!1;const n=t.reduce((c,[,u])=>c+u,0);return o[l]===0?n<=2:o[l]===1?n===0&&N.tokens[l]>=3:!1}function Xe(){const l=window.open("show_people.html","hand");setTimeout(()=>{l?.postMessage({type:"HAND_UPDATE",players:C},"*")},300)}function $e(l,e){Q.forEach(o=>{o.x<=l&&l<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&o.action()})}function Ke(l,e){W.forEach(o=>{if(o.contains(l,e)){const t=o.color;N.tokens[t]>0&&(ze(t)?(N.tokens[t]--,o.value=N.tokens[t],C[g.cornerIndex].tmp.tokens[t]++):($(),L()))}})}function qe(l,e){T.forEach(o=>{const t=o.closeCard,i=t.contains(l,e);i&&t.card!==null&&(L(),t.card.isSelected=i,j(t.card)),o.openCards.forEach(n=>{n.contains(l,e)&&n.card!==null&&(L(),n.card.isSelected=!0,j(n.card))})}),Y.forEach((o,t)=>{t===g.cornerIndex&&o.coveredCards.forEach(i=>{i.contains(l,e)&&i.card!==null&&(L(),i.card.isSelected=!0,j(i.card))})})}function M(){const l=ye();g.pointTo(l,!0)}function Ee(){let l=!0;C.forEach(e=>{e.isClean()||(l=!1)}),l&&Be(g.cornerIndex)}function Je(l,e){Y.forEach((o,t)=>{o.btnIn.contains(l,e)?sl(t):o.btnOut.contains(l,e)&&il(t)})}function Qe(l,e){X.forEach((o,t)=>{if(o.contains(l,e))for(let i=0;i<=R;i++)Ce(i,t,!0)})}function Ze(l){const e=C[g.cornerIndex];e.tokens.tokens[l]--,e.tmp.tokens[l]++}function Ve(l,e){Y.forEach(o=>{o.tokens.forEach(t=>{t.contains(l,e)&&Ze(t.color)})})}function el(l,e){g.contains(l,e)&&(M(),Ee())}function le(){const l=C[g.cornerIndex],e=l.tmp.tokens,o=l.tokens.tokens;for(const t of Object.values(h))o[t]+=e[t];l.tmp=new P}function $(){const l=C[g.cornerIndex],e=l.tmp.tokens,o=N.tokens;for(const t of Object.values(h))o[t]+=e[t];l.tmp=new P}function ll(){confirm("é€€éŒ¯è«‹æŒ‰ã€Œç¢ºå®šã€æ”¶å›ï¼›ä¸èƒ½ç›´æ¥æ‹¿ï¼è«‹æŒ‰ã€Œå–æ¶ˆã€é‚„éŠ€è¡Œ")?le():($(),L())}function ol(){confirm("ç¢ºå®šä¸æ‹¿ç°è‰²ï¼Ÿ")&&C[g.cornerIndex].coveredCards.length<3&&oe()}function rl(){confirm("ä¸èƒ½è²·ï¼Œæ˜¯å¦æ”¶å…¥è“‹ç‰Œä¸­ï¼Ÿ")&&C[g.cornerIndex].coveredCards.length<3&&oe()}function ge(){T.forEach(l=>{let e=l.closeCard.card;e!==null&&e==S&&(e=l.backStack.shift()??null),l.openCards.forEach(o=>{if(o.card!==null&&o.card==S){const t=l.backStack.shift()??null;o.card=t}})})}function oe(){const l=g.cornerIndex,e=C[l];S!==null&&e.coveredCards.push(S),le(),ge(),L();const o=e.showGreen()?1:0;Object.entries(e.tokens.tokens).reduce((i,[,n])=>i+n,0)+o<=10&&(z(l),M())}function tl(l,e,o,t,i){if(S===null)return;const n=l+e+o+t+i,c=S,u=C[g.cornerIndex],a=u.tokens.tokens,d=Math.max(c.price[r.YELLOW]-u.getYellowCardsCount(),0),p=Math.max(c.price[r.BLUE]-u.getBlueCardsCount(),0),A=Math.max(c.price[r.ORANGE]-u.getOrangeCardsCount(),0),w=Math.max(c.price[r.RED]-u.getRedCardsCount(),0),b=Math.max(c.price[r.PURPLE]-u.getPurpleCardsCount(),0);a[h.YELLOW]-=d,a[h.YELLOW]=Math.max(a[h.YELLOW],0),a[h.BLUE]-=p,a[h.BLUE]=Math.max(a[h.BLUE],0),a[h.ORANGE]-=A,a[h.ORANGE]=Math.max(a[h.ORANGE],0),a[h.RED]-=w,a[h.RED]=Math.max(a[h.RED],0),a[h.PURPLE]-=b,a[h.PURPLE]=Math.max(a[h.PURPLE],0),a[h.GRAY]-=n;const k=N.tokens;k[h.YELLOW]+=d-l,k[h.BLUE]+=p-e,k[h.ORANGE]+=A-o,k[h.RED]+=w-t,k[h.PURPLE]+=b-i,k[h.GRAY]+=n}function me(){const l=C.find(t=>t.hasA),e=C.filter(t=>t.getNumOfA()>=3).sort((t,i)=>i.getNumOfA()-t.getNumOfA());if(e.length===0)return;const o=e[0];if(!l){o.hasA=!0;return}o.getNumOfA()>l.getNumOfA()&&(l.hasA=!1,o.hasA=!0)}function nl(){const l=g.cornerIndex,e=C[l],o=[];I.forEach((i,n)=>{i!==null&&i[r.YELLOW]<=e.getYellowCardsCount()&&i[r.BLUE]<=e.getBlueCardsCount()&&i[r.ORANGE]<=e.getOrangeCardsCount()&&i[r.RED]<=e.getRedCardsCount()&&i[r.PURPLE]<=e.getPurpleCardsCount()&&o.push(n)});const t=o.length;return t===0?(me(),!0):t===1?(Ce(l,o[0]),!0):(alert("è«‹é¸ä¸€å¼µåŸå¸‚å¡"),!1)}function Ce(l,e,o=!1){if(g.cornerIndex!==l)return;const i=C[l];let n=I[e];n!==null&&n[r.YELLOW]<=i.getYellowCardsCount()&&n[r.BLUE]<=i.getBlueCardsCount()&&n[r.ORANGE]<=i.getOrangeCardsCount()&&n[r.RED]<=i.getRedCardsCount()&&n[r.PURPLE]<=i.getPurpleCardsCount()&&(i.city.push(n),I[e]=null),me(),o&&(z(l),M())}function sl(l){if(g.cornerIndex!==l)return;const e=C[l],o=e.tokens.tokens,t=e.tmp.tokens;if(t[h.GRAY]!==0)if(S===null||e.coveredCards.some(c=>c.name===S?.name)){ll();return}else{oe();return}const n=Object.entries(t).filter(([c])=>c!==h.GRAY.toString()).reduce((c,[,u])=>c+u,0);if(S==null)if(n>0){le();const c=e.showGreen()?1:0;Object.entries(o).reduce((a,[,d])=>a+d,0)+c<=10&&(z(l),M())}else return;else if(n>0)$(),L();else{if(e.coveredCards.length<3&&T.some(y=>y.closeCard.card==S)){ol();return}const c=S,u=e.getYellowCardsCount()+o[h.YELLOW],a=e.getBlueCardsCount()+o[h.BLUE],d=e.getOrangeCardsCount()+o[h.ORANGE],p=e.getRedCardsCount()+o[h.RED],A=e.getPurpleCardsCount()+o[h.PURPLE],w=c.price[r.YELLOW]>u?c.price[r.YELLOW]-u:0,b=c.price[r.BLUE]>a?c.price[r.BLUE]-a:0,k=c.price[r.ORANGE]>d?c.price[r.ORANGE]-d:0,D=c.price[r.RED]>p?c.price[r.RED]-p:0,H=c.price[r.PURPLE]>A?c.price[r.PURPLE]-A:0,B=w+b+k+D+H;if(o[h.GRAY]>=B){if(tl(w,b,k,D,H),e.addCard(c),e.coveredCards.some(O=>O.name===c.name)){const O=e.coveredCards.findIndex(v=>v.name===c.name);O!==-1&&e.coveredCards.splice(O,1)}else ge();nl()&&(z(l),M())}else{rl();return}L()}}function il(l){g.cornerIndex===l&&($(),L())}function z(l){if(l!==(R-1+ee)%R)return;if(Array.from({length:R},(c,u)=>C[u].canWin())[l]){C[l].isWinner=!0;return}const o=C.filter(c=>c.canWin());if(o.length===0)return;const t=o.sort((c,u)=>u.getScores()-c.getScores()),i=t.filter(c=>c.getScores()===t[0].getScores());if(i.length===1){i[0].isWinner=!0;return}console.log("===Blaze=== 5");const n=i.find(c=>c.hasA);if(n)n.isWinner=!0;else{const c=i.sort((a,d)=>a.people.length-d.people.length);c.filter(a=>a.people.length===c[0].people.length).forEach(a=>a.isWinner=!0)}}let T=[],X=[],W=[],Y=[];const g=new Pe(200,200,48),m=document.getElementById("canvas"),E=m.getContext("2d"),f=10,cl=1/20,al=1/40,ul=1/50,dl=1/40,hl=1/40;let Z=0,re=0,we=0;function fl(){const l=m.width*cl,e=l*2,o=l+f,t=m.width/2-l*1.5-f*1;re=t+l*4+f*3;const i=(m.height-U)/2-e*1.5-f;Z=i,T.forEach((n,c)=>{if(n.y=i+c*(e+f),n.openCards.length===0)for(let a=0;a<4;a++){const d=n.backStack.shift()??null;n.openCards.push(new se(d,n.color,t+a*o,n.y,l,e))}else n.openCards.forEach((a,d)=>{a.x=t+d*o,a.y=n.y,a.width=l,a.height=e});const u=n.backStack.length;n.closeCard.card=u>0?n.backStack[0]:null,n.closeCard.cardLeft=u,n.closeCard.x=t-o,n.closeCard.y=n.y,n.closeCard.width=l,n.closeCard.height=e})}function pl(){const l=m.width*al,e=l,o=l+f,t=re+f;we=Z+2*e+f,X=[],I.forEach((i,n)=>{const c=n%2,u=n<2?0:1;X.push(new fe(i,t+c*o,Z+u*(e+f),l,e))})}function El(){const l=m.width*dl/2,e=l*2+f,o=re+f,t=we+f;W=[],Object.values(h).forEach((i,n)=>{const c=n%2,u=Math.floor(n/2);W.push(new J(N.tokens[i],i,o+c*e,t+u*e,l))})}function gl(){const l=m.width*ul,e=l*6+f*4,o=.8,t=f+(l+f)*8+(l*o+f)*3,i=4;Y.forEach((n,c)=>{const u=C[c],a=c<2?f:m.width-f-t;let d=a+l,p=c===0||c===3?m.height-f-l:U+f+e;const A=c===0||c===3?p-e*2:p+l;let w=u.isWinner?"./res/thanos.webp":"";const b=Math.min(t,e);n.showWinner=new x(w,a,A,b,b,_),n.btnIn=new G("IN","#f0f",d,p,0,l*2,l,!0,!0),d+=l*2+f*2,n.btnOut=new G("OUT","#f0f",d,p,0,l*2,l,!0,!0),d+=l*2+f*2,w=ee===c?"./res/first.png":"",n.showFirst=new x(w,d,p,l*2,l,_),p-=l+f,d=a,n.scores=new pe(`åˆ†ï¼š${u.getScores()} Aï¼š${u.getNumOfA()}`,d,p,l*4,l),d+=n.scores.width+f,u.city.forEach((y,O)=>{const v=new fe(y,d+O*(l+f),p,l,l);n.cities.push(v)});const k=u.city.length;let D=Array.from({length:i-k},(y,O)=>new G("",q,d+(k+O)*(l+f),p,0,l,l,!0,!1));n.cities.push(...D),d+=i*(l+f),w=u.hasA?"./res/marvel_a.png":"",n.a=new x(w,d,p,l,l,_),p-=l+f,d=a,n.tokens=[],Object.values(h).forEach(y=>{n.tokens.push(new J(u.tokens.tokens[y],y,d,p,l/2)),d+=l+f});const H=u.showGreen();n.green=new G("G","#0F0",d,p,l/2,0,0,!1,H),d+=(l+f)*2,n.tmpTokens=[],Object.values(h).forEach(y=>{const O=u.tmp.tokens[y],v=n.tmpTokens.length;O>0&&n.tmpTokens.push(new J(O,y,d+v*(l*.8+f),p,l*o/2))}),d=a,p-=l+f,n.people=[],Object.values(r).forEach((y,O)=>{const v=u.getCardsCount(y);n.people.push(new G(String(v),ne[y],d+O*(l+f),p,0,l,l,!0,v>0))});const B=l*1.5;p-=B*2+f,n.coveredCards=[],u.coveredCards.forEach((y,O)=>{n.coveredCards.push(new se(y,y.color,d+O*(B+f),p,B,B*2))})})}function ml(){const l=W[W.length-1];g.size=m.width*hl,g.x=l.x,g.y=l.y+l.r*2+f+g.size}const U=30;function Cl(){const l=m.width/Q.length;Q.forEach((e,o)=>{const t=o*l,i=0;e.x=t,e.y=i,e.width=l,e.height=U,E.fillStyle="#fff",E.fillRect(t+2,i,l-4,U),E.font="20px Arial",E.textAlign="center",E.textBaseline="middle",E.fillStyle="#000",E.fillText(e.icon,t+l/2-30,U/2),E.font="16px Arial",E.fillText(e.title,t+l/2+30,U/2)})}function wl(){T.forEach(l=>{l.closeCard.draw(E),l.openCards.forEach(e=>e.draw(E))})}function yl(){X.forEach(l=>l.draw(E))}function Ol(){W.forEach(l=>l.draw(E))}function _(){Y.forEach(l=>{l.people.forEach(e=>e.draw(E)),l.tokens.forEach(e=>e.draw(E)),l.green.draw(E),l.tmpTokens.forEach(e=>e.draw(E)),l.scores.draw(E),l.cities.forEach(e=>e.draw(E)),l.a.draw(E),l.btnIn.draw(E),l.btnOut.draw(E),l.showFirst.draw(E),l.coveredCards.forEach(e=>e.draw(E)),l.showWinner.draw(E)})}function ye(){return[{x:0,y:m.height},{x:0,y:0},{x:m.width,y:0},{x:m.width,y:m.height}].slice(0,R)}function Al(){const l=ye();g.pointTo(l,!1),g.draw(E)}function te(){E.clearRect(0,0,m.width,m.height),Cl(),fl(),wl(),pl(),yl(),El(),Ol(),gl(),_(),ml(),Al()}function V(){m.width=window.innerWidth,m.height=window.innerHeight,T=De(),He(),je(),Y=Fe(),g.resetCornerIndex(),Ee(),te()}function Rl(){m.width=window.innerWidth,m.height=window.innerHeight,te()}m.addEventListener("click",l=>{const e=m.getBoundingClientRect(),o=l.clientX-e.left,t=l.clientY-e.top;_e(o,t)});window.addEventListener("resize",Rl);V();
